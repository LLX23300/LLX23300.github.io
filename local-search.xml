<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Playbookçš„ç¼–å†™</title>
    <link href="/2026/01/12/2026.1.12-1/"/>
    <url>/2026/01/12/2026.1.12-1/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€å…ˆç»™ä½ ä¸€ä¸ªâ€œéª¨æ¶è®¤çŸ¥â€ï¼ˆæœ€é‡è¦ï¼‰"><a href="#ä¸€ã€å…ˆç»™ä½ ä¸€ä¸ªâ€œéª¨æ¶è®¤çŸ¥â€ï¼ˆæœ€é‡è¦ï¼‰" class="headerlink" title="ä¸€ã€å…ˆç»™ä½ ä¸€ä¸ªâ€œéª¨æ¶è®¤çŸ¥â€ï¼ˆæœ€é‡è¦ï¼‰"></a>ä¸€ã€å…ˆç»™ä½ ä¸€ä¸ªâ€œéª¨æ¶è®¤çŸ¥â€ï¼ˆæœ€é‡è¦ï¼‰</h2><blockquote><p><strong>Playbook &#x3D; ç”¨ YAML å†™çš„â€œæœåŠ¡å™¨ç›®æ ‡çŠ¶æ€è¯´æ˜ä¹¦â€</strong></p></blockquote><p>å®ƒå›ç­” 3 ä¸ªé—®é¢˜ï¼š</p><ol><li><strong>ç®¡è°ï¼Ÿ</strong>ï¼ˆhostsï¼‰</li><li><strong>ç”¨ä»€ä¹ˆæƒé™ï¼Ÿ</strong>ï¼ˆbecomeï¼‰</li><li><strong>è¦å®ƒå˜æˆä»€ä¹ˆæ ·ï¼Ÿ</strong>ï¼ˆtasksï¼‰</li></ol><hr><h2 id="äºŒã€æœ€å°å¯ç”¨-Playbookï¼ˆä½ ä»¥åå†™çš„éƒ½é•¿è¿™ä¸ªæ ·ï¼‰"><a href="#äºŒã€æœ€å°å¯ç”¨-Playbookï¼ˆä½ ä»¥åå†™çš„éƒ½é•¿è¿™ä¸ªæ ·ï¼‰" class="headerlink" title="äºŒã€æœ€å°å¯ç”¨ Playbookï¼ˆä½ ä»¥åå†™çš„éƒ½é•¿è¿™ä¸ªæ ·ï¼‰"></a>äºŒã€æœ€å°å¯ç”¨ Playbookï¼ˆä½ ä»¥åå†™çš„éƒ½é•¿è¿™ä¸ªæ ·ï¼‰</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Example</span> <span class="hljs-string">playbook</span><br>  <span class="hljs-attr">hosts:</span> <span class="hljs-string">web</span><br>  <span class="hljs-attr">become:</span> <span class="hljs-literal">yes</span><br><br>  <span class="hljs-attr">tasks:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">install</span> <span class="hljs-string">vim</span><br>      <span class="hljs-attr">dnf:</span><br>        <span class="hljs-attr">name:</span> <span class="hljs-string">vim-enhanced</span><br>        <span class="hljs-attr">state:</span> <span class="hljs-string">present</span><br></code></pre></td></tr></table></figure><p>ä½ å¯ä»¥æŠŠå®ƒè¯»æˆä¸€å¥äººè¯ï¼š</p><blockquote><p>â€œåœ¨ web è¿™ç»„æœåŠ¡å™¨ä¸Šï¼Œç”¨ root æƒé™ï¼Œç¡®ä¿ vim å·²ç»å®‰è£…ã€‚â€</p></blockquote><hr><h2 id="ä¸‰ã€Playbook-çš„-5-ä¸ªæ ¸å¿ƒç»“æ„ï¼ˆè®°ä½è¿™-5-ä¸ªï¼‰"><a href="#ä¸‰ã€Playbook-çš„-5-ä¸ªæ ¸å¿ƒç»“æ„ï¼ˆè®°ä½è¿™-5-ä¸ªï¼‰" class="headerlink" title="ä¸‰ã€Playbook çš„ 5 ä¸ªæ ¸å¿ƒç»“æ„ï¼ˆè®°ä½è¿™ 5 ä¸ªï¼‰"></a>ä¸‰ã€Playbook çš„ 5 ä¸ªæ ¸å¿ƒç»“æ„ï¼ˆè®°ä½è¿™ 5 ä¸ªï¼‰</h2><h3 id="1ï¸âƒ£-Playï¼ˆä¸€æ®µä»¥-å¼€å¤´çš„é…ç½®ï¼‰"><a href="#1ï¸âƒ£-Playï¼ˆä¸€æ®µä»¥-å¼€å¤´çš„é…ç½®ï¼‰" class="headerlink" title="1ï¸âƒ£ Playï¼ˆä¸€æ®µä»¥ - å¼€å¤´çš„é…ç½®ï¼‰"></a>1ï¸âƒ£ Playï¼ˆä¸€æ®µä»¥ <code>-</code> å¼€å¤´çš„é…ç½®ï¼‰</h3><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-bullet">-</span> <span class="hljs-string">name: xxx</span><br>  <span class="hljs-attribute">hosts</span><span class="hljs-punctuation">:</span> <span class="hljs-string">web</span><br></code></pre></td></tr></table></figure><ul><li>ä¸€ä¸ª playbook <strong>å¯ä»¥æœ‰å¤šä¸ª play</strong></li><li>æ¯ä¸ª play ä½œç”¨äºä¸€ç»„ä¸»æœº</li></ul><hr><h3 id="2ï¸âƒ£-hostsï¼ˆä»-inventory-é‡Œé€‰ç›®æ ‡ï¼‰"><a href="#2ï¸âƒ£-hostsï¼ˆä»-inventory-é‡Œé€‰ç›®æ ‡ï¼‰" class="headerlink" title="2ï¸âƒ£ hostsï¼ˆä» inventory é‡Œé€‰ç›®æ ‡ï¼‰"></a>2ï¸âƒ£ hostsï¼ˆä» inventory é‡Œé€‰ç›®æ ‡ï¼‰</h3><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">hosts:</span> web<br></code></pre></td></tr></table></figure><p>ç­‰ä»·äºå‘½ä»¤è¡Œï¼š</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-function"><span class="hljs-title">ansible</span></span> web ...<br></code></pre></td></tr></table></figure><hr><h3 id="3ï¸âƒ£-becomeï¼ˆææƒï¼‰"><a href="#3ï¸âƒ£-becomeï¼ˆææƒï¼‰" class="headerlink" title="3ï¸âƒ£ becomeï¼ˆææƒï¼‰"></a>3ï¸âƒ£ becomeï¼ˆææƒï¼‰</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">become:</span> <span class="hljs-literal">yes</span><br></code></pre></td></tr></table></figure><p>å«ä¹‰ï¼š</p><blockquote><p>ç”¨æ™®é€šç”¨æˆ·ç™»å½•ï¼Œä½†æ‰§è¡Œä»»åŠ¡æ—¶ sudo æˆ root</p></blockquote><hr><h3 id="4ï¸âƒ£-tasksï¼ˆçœŸæ­£å¹²æ´»çš„åœ°æ–¹ï¼‰"><a href="#4ï¸âƒ£-tasksï¼ˆçœŸæ­£å¹²æ´»çš„åœ°æ–¹ï¼‰" class="headerlink" title="4ï¸âƒ£ tasksï¼ˆçœŸæ­£å¹²æ´»çš„åœ°æ–¹ï¼‰"></a>4ï¸âƒ£ tasksï¼ˆçœŸæ­£å¹²æ´»çš„åœ°æ–¹ï¼‰</h3><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">tasks</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">name: xxx</span><br>    <span class="hljs-attribute">module</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-attribute">option</span><span class="hljs-punctuation">:</span> <span class="hljs-string">value</span><br></code></pre></td></tr></table></figure><p><strong>95% çš„æ—¶é—´ä½ éƒ½åœ¨å†™ tasks</strong></p><hr><h3 id="5ï¸âƒ£-moduleï¼ˆAnsible-çš„â€œåŠ¨ä½œâ€ï¼‰"><a href="#5ï¸âƒ£-moduleï¼ˆAnsible-çš„â€œåŠ¨ä½œâ€ï¼‰" class="headerlink" title="5ï¸âƒ£ moduleï¼ˆAnsible çš„â€œåŠ¨ä½œâ€ï¼‰"></a>5ï¸âƒ£ moduleï¼ˆAnsible çš„â€œåŠ¨ä½œâ€ï¼‰</h3><p>ä¾‹å¦‚ï¼š</p><ul><li><code>dnf</code> â†’ è£…è½¯ä»¶</li><li><code>service</code> â†’ ç®¡æœåŠ¡</li><li><code>file</code> â†’ ç®¡æ–‡ä»¶</li><li><code>user</code> â†’ ç®¡ç”¨æˆ·</li></ul><hr><h2 id="å››ã€ä¸€ä¸ªå®Œæ•´ã€è§„èŒƒçš„ç¤ºä¾‹ï¼ˆå¼ºçƒˆå»ºè®®ä½ ç…§ç€æŠ„ï¼‰"><a href="#å››ã€ä¸€ä¸ªå®Œæ•´ã€è§„èŒƒçš„ç¤ºä¾‹ï¼ˆå¼ºçƒˆå»ºè®®ä½ ç…§ç€æŠ„ï¼‰" class="headerlink" title="å››ã€ä¸€ä¸ªå®Œæ•´ã€è§„èŒƒçš„ç¤ºä¾‹ï¼ˆå¼ºçƒˆå»ºè®®ä½ ç…§ç€æŠ„ï¼‰"></a>å››ã€ä¸€ä¸ªå®Œæ•´ã€è§„èŒƒçš„ç¤ºä¾‹ï¼ˆå¼ºçƒˆå»ºè®®ä½ ç…§ç€æŠ„ï¼‰</h2><h3 id="ç¤ºä¾‹ï¼šå®‰è£…å¹¶å¯åŠ¨-nginx"><a href="#ç¤ºä¾‹ï¼šå®‰è£…å¹¶å¯åŠ¨-nginx" class="headerlink" title="ç¤ºä¾‹ï¼šå®‰è£…å¹¶å¯åŠ¨ nginx"></a>ç¤ºä¾‹ï¼šå®‰è£…å¹¶å¯åŠ¨ nginx</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">and</span> <span class="hljs-string">start</span> <span class="hljs-string">nginx</span><br>  <span class="hljs-attr">hosts:</span> <span class="hljs-string">web</span><br>  <span class="hljs-attr">become:</span> <span class="hljs-literal">yes</span><br><br>  <span class="hljs-attr">tasks:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">install</span> <span class="hljs-string">nginx</span><br>      <span class="hljs-attr">dnf:</span><br>        <span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span><br>        <span class="hljs-attr">state:</span> <span class="hljs-string">present</span><br><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">start</span> <span class="hljs-string">nginx</span><br>      <span class="hljs-attr">service:</span><br>        <span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span><br>        <span class="hljs-attr">state:</span> <span class="hljs-string">started</span><br>        <span class="hljs-attr">enabled:</span> <span class="hljs-literal">yes</span><br></code></pre></td></tr></table></figure><p>æ‰§è¡Œï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">ansible-playbook nginx.yml<br></code></pre></td></tr></table></figure><hr><h2 id="äº”ã€Playbook-ç¼–å†™çš„-6-ä¸ªâ€œé“å¾‹â€ï¼ˆå¾ˆé‡è¦ï¼‰"><a href="#äº”ã€Playbook-ç¼–å†™çš„-6-ä¸ªâ€œé“å¾‹â€ï¼ˆå¾ˆé‡è¦ï¼‰" class="headerlink" title="äº”ã€Playbook ç¼–å†™çš„ 6 ä¸ªâ€œé“å¾‹â€ï¼ˆå¾ˆé‡è¦ï¼‰"></a>äº”ã€Playbook ç¼–å†™çš„ 6 ä¸ªâ€œé“å¾‹â€ï¼ˆå¾ˆé‡è¦ï¼‰</h2><h3 id="âœ…-1ï¸âƒ£-ä¸€ä¸ª-task-åªå¹²ä¸€ä»¶äº‹"><a href="#âœ…-1ï¸âƒ£-ä¸€ä¸ª-task-åªå¹²ä¸€ä»¶äº‹" class="headerlink" title="âœ… 1ï¸âƒ£ ä¸€ä¸ª task åªå¹²ä¸€ä»¶äº‹"></a>âœ… 1ï¸âƒ£ <strong>ä¸€ä¸ª task åªå¹²ä¸€ä»¶äº‹</strong></h3><p>âŒ é”™è¯¯ç¤ºä¾‹ï¼ˆæ€ç»´åƒ shellï¼‰ï¼š</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">- <span class="hljs-keyword">shell: </span>yum <span class="hljs-keyword">install </span>nginx &amp;&amp; systemctl start nginx<br></code></pre></td></tr></table></figure><p>âœ… æ­£ç¡®ï¼š</p><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pf">- dnf:<br>    name: nginx<br>    <span class="hljs-keyword">state</span>: present<br><br>- service:<br>    name: nginx<br>    <span class="hljs-keyword">state</span>: started<br></code></pre></td></tr></table></figure><hr><h3 id="âœ…-2ï¸âƒ£-æ°¸è¿œè¿½æ±‚â€œå¹‚ç­‰æ€§â€"><a href="#âœ…-2ï¸âƒ£-æ°¸è¿œè¿½æ±‚â€œå¹‚ç­‰æ€§â€" class="headerlink" title="âœ… 2ï¸âƒ£ æ°¸è¿œè¿½æ±‚â€œå¹‚ç­‰æ€§â€"></a>âœ… 2ï¸âƒ£ æ°¸è¿œè¿½æ±‚â€œå¹‚ç­‰æ€§â€</h3><blockquote><p><strong>å¤šè·‘å‡ æ¬¡ï¼Œç»“æœä¸€æ ·</strong></p></blockquote><p>è¿™æ˜¯ Ansible çš„çµé­‚ã€‚</p><hr><h3 id="âœ…-3ï¸âƒ£-å¿…é¡»å†™-name"><a href="#âœ…-3ï¸âƒ£-å¿…é¡»å†™-name" class="headerlink" title="âœ… 3ï¸âƒ£ å¿…é¡»å†™ name"></a>âœ… 3ï¸âƒ£ å¿…é¡»å†™ <code>name</code></h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-bullet">- </span>name: install nginx<br></code></pre></td></tr></table></figure><p>ä»¥åå‡ºé”™æ—¶ï¼Œå…¨é å®ƒå®šä½é—®é¢˜ã€‚</p><hr><h3 id="âœ…-4ï¸âƒ£-ä¸è¦ä¸€å¼€å§‹å°±ç”¨-shell"><a href="#âœ…-4ï¸âƒ£-ä¸è¦ä¸€å¼€å§‹å°±ç”¨-shell" class="headerlink" title="âœ… 4ï¸âƒ£ ä¸è¦ä¸€å¼€å§‹å°±ç”¨ shell"></a>âœ… 4ï¸âƒ£ ä¸è¦ä¸€å¼€å§‹å°±ç”¨ <code>shell</code></h3><p>åªæœ‰åœ¨ <strong>æ²¡æœ‰æ¨¡å—å¯ç”¨</strong> æ—¶ï¼Œæ‰ç”¨ï¼š</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">shell:</span><br></code></pre></td></tr></table></figure><hr><h3 id="âœ…-5ï¸âƒ£-ç¼©è¿›æ˜¯ç”Ÿå‘½ï¼ˆYAML-è§„åˆ™ï¼‰"><a href="#âœ…-5ï¸âƒ£-ç¼©è¿›æ˜¯ç”Ÿå‘½ï¼ˆYAML-è§„åˆ™ï¼‰" class="headerlink" title="âœ… 5ï¸âƒ£ ç¼©è¿›æ˜¯ç”Ÿå‘½ï¼ˆYAML è§„åˆ™ï¼‰"></a>âœ… 5ï¸âƒ£ ç¼©è¿›æ˜¯ç”Ÿå‘½ï¼ˆYAML è§„åˆ™ï¼‰</h3><ul><li>åªèƒ½ç”¨ç©ºæ ¼</li><li>ä¸èƒ½ç”¨ Tab</li><li>å¸¸ç”¨ <strong>2 ä¸ªç©ºæ ¼</strong></li></ul><hr><h3 id="âœ…-6ï¸âƒ£-æ¨¡å—-å‘½ä»¤"><a href="#âœ…-6ï¸âƒ£-æ¨¡å—-å‘½ä»¤" class="headerlink" title="âœ… 6ï¸âƒ£ æ¨¡å— &gt; å‘½ä»¤"></a>âœ… 6ï¸âƒ£ æ¨¡å— &gt; å‘½ä»¤</h3><blockquote><p>èƒ½ç”¨æ¨¡å—ï¼Œå°±ä¸ç”¨å‘½ä»¤</p></blockquote><hr><h2 id="å…­ã€å˜é‡ï¼ˆä½ å·²ç»è¯¥å¼€å§‹ç”¨äº†ï¼‰"><a href="#å…­ã€å˜é‡ï¼ˆä½ å·²ç»è¯¥å¼€å§‹ç”¨äº†ï¼‰" class="headerlink" title="å…­ã€å˜é‡ï¼ˆä½ å·²ç»è¯¥å¼€å§‹ç”¨äº†ï¼‰"></a>å…­ã€å˜é‡ï¼ˆä½ å·²ç»è¯¥å¼€å§‹ç”¨äº†ï¼‰</h2><h3 id="å®šä¹‰å˜é‡"><a href="#å®šä¹‰å˜é‡" class="headerlink" title="å®šä¹‰å˜é‡"></a>å®šä¹‰å˜é‡</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">vars:</span><br><span class="hljs-symbol">  pkg_name:</span> vim-enhanced<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨å˜é‡ï¼š</p><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pf">- dnf:<br>    name: <span class="hljs-string">&quot;&#123;&#123; pkg_name &#125;&#125;&quot;</span><br>    <span class="hljs-keyword">state</span>: present<br></code></pre></td></tr></table></figure><p>ğŸ‘‰ <strong>Playbook &#x3D; æ¨¡æ¿ï¼Œä¸æ˜¯æ­»å‘½ä»¤</strong></p><hr><h2 id="ä¸ƒã€handlersï¼ˆéå¸¸å…³é”®ï¼Œä¼ä¸šå¿…ç”¨ï¼‰"><a href="#ä¸ƒã€handlersï¼ˆéå¸¸å…³é”®ï¼Œä¼ä¸šå¿…ç”¨ï¼‰" class="headerlink" title="ä¸ƒã€handlersï¼ˆéå¸¸å…³é”®ï¼Œä¼ä¸šå¿…ç”¨ï¼‰"></a>ä¸ƒã€handlersï¼ˆéå¸¸å…³é”®ï¼Œä¼ä¸šå¿…ç”¨ï¼‰</h2><blockquote><p><strong>â€œåªæœ‰é…ç½®å˜äº†ï¼Œæ‰é‡å¯æœåŠ¡â€</strong></p></blockquote><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">hosts:</span> <span class="hljs-string">web</span><br>  <span class="hljs-attr">become:</span> <span class="hljs-literal">yes</span><br><br>  <span class="hljs-attr">tasks:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">copy</span> <span class="hljs-string">nginx</span> <span class="hljs-string">config</span><br>      <span class="hljs-attr">copy:</span><br>        <span class="hljs-attr">src:</span> <span class="hljs-string">nginx.conf</span><br>        <span class="hljs-attr">dest:</span> <span class="hljs-string">/etc/nginx/nginx.conf</span><br>      <span class="hljs-attr">notify:</span> <span class="hljs-string">restart</span> <span class="hljs-string">nginx</span><br><br>  <span class="hljs-attr">handlers:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">restart</span> <span class="hljs-string">nginx</span><br>      <span class="hljs-attr">service:</span><br>        <span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span><br>        <span class="hljs-attr">state:</span> <span class="hljs-string">restarted</span><br></code></pre></td></tr></table></figure><hr><h2 id="å…«ã€ä½ ç°åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæ¨èä½ æŒæ¡çš„æ¨¡å—æ¸…å•"><a href="#å…«ã€ä½ ç°åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæ¨èä½ æŒæ¡çš„æ¨¡å—æ¸…å•" class="headerlink" title="å…«ã€ä½ ç°åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæ¨èä½ æŒæ¡çš„æ¨¡å—æ¸…å•"></a>å…«ã€ä½ ç°åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæ¨èä½ æŒæ¡çš„æ¨¡å—æ¸…å•</h2><p>ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼š</p><ol><li><code>dnf</code></li><li><code>service</code></li><li><code>file</code></li><li><code>copy</code></li><li><code>template</code></li><li><code>user</code></li><li><code>lineinfile</code></li><li><code>ansible.posix.authorized_key</code></li></ol>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RHCE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¼ä¸šæµç¨‹Bootstrapå¼€è’</title>
    <link href="/2026/01/12/2026.1.12-2/"/>
    <url>/2026/01/12/2026.1.12-2/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€æ•´ä½“æµç¨‹å…ˆç»™ä½ ä¸€å¼ â€œå…¨æ™¯å›¾â€"><a href="#ä¸€ã€æ•´ä½“æµç¨‹å…ˆç»™ä½ ä¸€å¼ â€œå…¨æ™¯å›¾â€" class="headerlink" title="ä¸€ã€æ•´ä½“æµç¨‹å…ˆç»™ä½ ä¸€å¼ â€œå…¨æ™¯å›¾â€"></a>ä¸€ã€æ•´ä½“æµç¨‹å…ˆç»™ä½ ä¸€å¼ â€œå…¨æ™¯å›¾â€</h1><p>ä½ ç°åœ¨è¦åšçš„äº‹ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ª <strong>Bootstrapï¼ˆå¼€è’ï¼‰æµç¨‹</strong>ï¼š</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xquery">æ–° VPSï¼ˆåªæœ‰<span class="hljs-built_in"> root</span>ï¼‰<br>        â†“<br>Ansibleï¼ˆç”¨<span class="hljs-built_in"> root</span> è¿ï¼‰<br>        â†“<br>åˆ›å»ºæ™®é€šç”¨æˆ· + sudo + SSH<span class="hljs-built_in"> key</span><br>        â†“<br>åˆ‡æ¢ inventory<br>        â†“<br>ä»¥ååªç”¨æ™®é€šç”¨æˆ· + become<br></code></pre></td></tr></table></figure><hr><h1 id="äºŒã€ç¯å¢ƒå‡è®¾ï¼ˆä½ å¯ä»¥å¯¹ç…§ï¼‰"><a href="#äºŒã€ç¯å¢ƒå‡è®¾ï¼ˆä½ å¯ä»¥å¯¹ç…§ï¼‰" class="headerlink" title="äºŒã€ç¯å¢ƒå‡è®¾ï¼ˆä½ å¯ä»¥å¯¹ç…§ï¼‰"></a>äºŒã€ç¯å¢ƒå‡è®¾ï¼ˆä½ å¯ä»¥å¯¹ç…§ï¼‰</h1><p>æˆ‘ç”¨ä½ çš„å®é™…ä¹ æƒ¯æ¥å‡è®¾ï¼ˆè´´åˆä½ ï¼‰ï¼š</p><h3 id="æ§åˆ¶èŠ‚ç‚¹ï¼ˆAnsibleï¼‰"><a href="#æ§åˆ¶èŠ‚ç‚¹ï¼ˆAnsibleï¼‰" class="headerlink" title="æ§åˆ¶èŠ‚ç‚¹ï¼ˆAnsibleï¼‰"></a>æ§åˆ¶èŠ‚ç‚¹ï¼ˆAnsibleï¼‰</h3><ul><li>ç”¨æˆ·ï¼š<code>kxllx</code></li><li>ç³»ç»Ÿï¼šAlmaLinux 9</li><li>å·²æœ‰ SSH keyï¼š<code>~/.ssh/id_rsa.pub</code></li></ul><h3 id="è¢«æ§èŠ‚ç‚¹ï¼ˆæ–°-VPSï¼‰"><a href="#è¢«æ§èŠ‚ç‚¹ï¼ˆæ–°-VPSï¼‰" class="headerlink" title="è¢«æ§èŠ‚ç‚¹ï¼ˆæ–° VPSï¼‰"></a>è¢«æ§èŠ‚ç‚¹ï¼ˆæ–° VPSï¼‰</h3><ul><li>IPï¼š<code>38.95.76.11</code></li><li>åˆå§‹ç”¨æˆ·ï¼š<code>root</code></li><li>åªæ”¯æŒå¯†ç  &#x2F; root key ç™»å½•</li></ul><hr><h1 id="ä¸‰ã€ç¬¬-0-æ­¥ï¼šå‡†å¤‡-Ansible-é¡¹ç›®ç»“æ„ï¼ˆå¾ˆé‡è¦ï¼‰"><a href="#ä¸‰ã€ç¬¬-0-æ­¥ï¼šå‡†å¤‡-Ansible-é¡¹ç›®ç»“æ„ï¼ˆå¾ˆé‡è¦ï¼‰" class="headerlink" title="ä¸‰ã€ç¬¬ 0 æ­¥ï¼šå‡†å¤‡ Ansible é¡¹ç›®ç»“æ„ï¼ˆå¾ˆé‡è¦ï¼‰"></a>ä¸‰ã€ç¬¬ 0 æ­¥ï¼šå‡†å¤‡ Ansible é¡¹ç›®ç»“æ„ï¼ˆå¾ˆé‡è¦ï¼‰</h1><p>åœ¨ <strong>æ§åˆ¶èŠ‚ç‚¹</strong> ä¸Šï¼Œç”¨æ™®é€šç”¨æˆ· <code>kxllx</code>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> -p ~/ansible-bootstrap<br><span class="hljs-built_in">cd</span> ~/ansible-bootstrap<br></code></pre></td></tr></table></figure><p>æ¨èç»“æ„ï¼ˆæˆ‘ä»¬ä¸€æ­¥æ­¥å¡«ï¼‰ï¼š</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs stata">ansible-<span class="hljs-keyword">bootstrap</span>/<br>â”œâ”€â”€ inventory/<br>â”‚   â”œâ”€â”€ hosts_root<br>â”‚   â””â”€â”€ hosts_user<br>â”œâ”€â”€ playbooks/<br>â”‚   â””â”€â”€ <span class="hljs-keyword">bootstrap</span>.yml<br>â””â”€â”€ ansible.cfg<br></code></pre></td></tr></table></figure><hr><h1 id="å››ã€ç¬¬-1-æ­¥ï¼šé…ç½®-ansible-cfgï¼ˆè®©åé¢æ›´èˆ’æœï¼‰"><a href="#å››ã€ç¬¬-1-æ­¥ï¼šé…ç½®-ansible-cfgï¼ˆè®©åé¢æ›´èˆ’æœï¼‰" class="headerlink" title="å››ã€ç¬¬ 1 æ­¥ï¼šé…ç½® ansible.cfgï¼ˆè®©åé¢æ›´èˆ’æœï¼‰"></a>å››ã€ç¬¬ 1 æ­¥ï¼šé…ç½® ansible.cfgï¼ˆè®©åé¢æ›´èˆ’æœï¼‰</h1><p><code>ansible.cfg</code>ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[defaults]</span><br><span class="hljs-attr">inventory</span> = inventory/hosts_root<br><span class="hljs-attr">host_key_checking</span> = <span class="hljs-literal">False</span><br><span class="hljs-attr">remote_user</span> = root<br></code></pre></td></tr></table></figure><p>è¯´æ˜ä¸€å¥äººè¯ï¼š</p><ul><li>é»˜è®¤ç”¨ <code>root</code></li><li>é»˜è®¤ç”¨ <code>hosts_root</code></li><li>ç¬¬ä¸€æ¬¡å¼€è’ï¼Œåˆç†</li></ul><hr><h1 id="äº”ã€ç¬¬-2-æ­¥ï¼šroot-é˜¶æ®µçš„-inventoryï¼ˆè¢«æ§èŠ‚ç‚¹åˆšåˆ°æ‰‹ï¼‰"><a href="#äº”ã€ç¬¬-2-æ­¥ï¼šroot-é˜¶æ®µçš„-inventoryï¼ˆè¢«æ§èŠ‚ç‚¹åˆšåˆ°æ‰‹ï¼‰" class="headerlink" title="äº”ã€ç¬¬ 2 æ­¥ï¼šroot é˜¶æ®µçš„ inventoryï¼ˆè¢«æ§èŠ‚ç‚¹åˆšåˆ°æ‰‹ï¼‰"></a>äº”ã€ç¬¬ 2 æ­¥ï¼šroot é˜¶æ®µçš„ inventoryï¼ˆè¢«æ§èŠ‚ç‚¹åˆšåˆ°æ‰‹ï¼‰</h1><p><code>inventory/hosts_root</code>ï¼š</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[bootstrap]</span><br><span class="hljs-number">38.95.76.11</span><br></code></pre></td></tr></table></figure><blockquote><p>æ­¤æ—¶ï¼š<br> ğŸ‘‰ Ansible &#x3D; root<br> ğŸ‘‰ ç›®æ ‡ &#x3D; æ–° VPS</p></blockquote><hr><h1 id="å…­ã€ç¬¬-3-æ­¥ï¼šå†™â€œå¼€è’æ ¸å¿ƒâ€-playbookï¼ˆé‡ç‚¹ï¼‰"><a href="#å…­ã€ç¬¬-3-æ­¥ï¼šå†™â€œå¼€è’æ ¸å¿ƒâ€-playbookï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="å…­ã€ç¬¬ 3 æ­¥ï¼šå†™â€œå¼€è’æ ¸å¿ƒâ€ playbookï¼ˆé‡ç‚¹ï¼‰"></a>å…­ã€ç¬¬ 3 æ­¥ï¼šå†™â€œå¼€è’æ ¸å¿ƒâ€ playbookï¼ˆé‡ç‚¹ï¼‰</h1><p>è¿™ä¸€æ­¥æ˜¯ç²¾å ğŸ‘‡<br> <strong>ç”¨ Ansible è‡ªåŠ¨åˆ›å»ºæ™®é€šç”¨æˆ· + SSH key + sudo</strong></p><p><code>playbooks/bootstrap.yml</code>ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Bootstrap</span> <span class="hljs-string">new</span> <span class="hljs-string">VPS</span><br>  <span class="hljs-attr">hosts:</span> <span class="hljs-string">bootstrap</span><br>  <span class="hljs-attr">gather_facts:</span> <span class="hljs-literal">no</span><br>  <span class="hljs-attr">become:</span> <span class="hljs-literal">no</span><br><br>  <span class="hljs-attr">vars:</span><br>    <span class="hljs-attr">new_user:</span> <span class="hljs-string">kxllx</span><br><br>  <span class="hljs-attr">tasks:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Create</span> <span class="hljs-string">normal</span> <span class="hljs-string">user</span><br>      <span class="hljs-attr">user:</span><br>        <span class="hljs-attr">name:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; new_user &#125;&#125;</span>&quot;</span><br>        <span class="hljs-attr">shell:</span> <span class="hljs-string">/bin/bash</span><br>        <span class="hljs-attr">groups:</span> <span class="hljs-string">wheel</span><br>        <span class="hljs-attr">append:</span> <span class="hljs-literal">yes</span><br>        <span class="hljs-attr">state:</span> <span class="hljs-string">present</span><br><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Create</span> <span class="hljs-string">.ssh</span> <span class="hljs-string">directory</span><br>      <span class="hljs-attr">file:</span><br>        <span class="hljs-attr">path:</span> <span class="hljs-string">&quot;/home/<span class="hljs-template-variable">&#123;&#123; new_user &#125;&#125;</span>/.ssh&quot;</span><br>        <span class="hljs-attr">state:</span> <span class="hljs-string">directory</span><br>        <span class="hljs-attr">owner:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; new_user &#125;&#125;</span>&quot;</span><br>        <span class="hljs-attr">group:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; new_user &#125;&#125;</span>&quot;</span><br>        <span class="hljs-attr">mode:</span> <span class="hljs-string">&#x27;0700&#x27;</span><br><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Set</span> <span class="hljs-string">authorized</span> <span class="hljs-string">key</span><br>      <span class="hljs-attr">authorized_key:</span><br>        <span class="hljs-attr">user:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; new_user &#125;&#125;</span>&quot;</span><br>        <span class="hljs-attr">key:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; lookup(&#x27;file&#x27;, &#x27;~/.ssh/id_rsa.pub&#x27;) &#125;&#125;</span>&quot;</span><br><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Ensure</span> <span class="hljs-string">wheel</span> <span class="hljs-string">group</span> <span class="hljs-string">can</span> <span class="hljs-string">sudo</span><br>      <span class="hljs-attr">lineinfile:</span><br>        <span class="hljs-attr">path:</span> <span class="hljs-string">/etc/sudoers</span><br>        <span class="hljs-attr">regexp:</span> <span class="hljs-string">&#x27;^%wheel&#x27;</span><br>        <span class="hljs-attr">line:</span> <span class="hljs-string">&#x27;%wheel ALL=(ALL) ALL&#x27;</span><br>        <span class="hljs-attr">validate:</span> <span class="hljs-string">&#x27;visudo -cf %s&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="è¿™ä»½-playbook-å¹²äº†ä»€ä¹ˆï¼Ÿ"><a href="#è¿™ä»½-playbook-å¹²äº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="è¿™ä»½ playbook å¹²äº†ä»€ä¹ˆï¼Ÿ"></a>è¿™ä»½ playbook å¹²äº†ä»€ä¹ˆï¼Ÿ</h3><table><thead><tr><th>æ­¥éª¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>user</td><td>åˆ›å»ºæ™®é€šç”¨æˆ·</td></tr><tr><td>groups: wheel</td><td>ç»™ sudo æƒé™</td></tr><tr><td>authorized_key</td><td>æ¨é€ SSH å…¬é’¥</td></tr><tr><td>sudoers</td><td>ç¡®ä¿ wheel èƒ½ sudo</td></tr></tbody></table><p>ğŸ‘‰ <strong>è¿™æ˜¯ 90% ä¼ä¸šçš„â€œæ ‡å‡†å¼€è’è„šæœ¬â€</strong></p><hr><h1 id="ä¸ƒã€ç¬¬-4-æ­¥ï¼šæ‰§è¡Œ-Bootstrapï¼ˆå”¯ä¸€ä¸€æ¬¡-rootï¼‰"><a href="#ä¸ƒã€ç¬¬-4-æ­¥ï¼šæ‰§è¡Œ-Bootstrapï¼ˆå”¯ä¸€ä¸€æ¬¡-rootï¼‰" class="headerlink" title="ä¸ƒã€ç¬¬ 4 æ­¥ï¼šæ‰§è¡Œ Bootstrapï¼ˆå”¯ä¸€ä¸€æ¬¡ rootï¼‰"></a>ä¸ƒã€ç¬¬ 4 æ­¥ï¼šæ‰§è¡Œ Bootstrapï¼ˆå”¯ä¸€ä¸€æ¬¡ rootï¼‰</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ansible-playbook playbooks/bootstrap.yml<br></code></pre></td></tr></table></figure><p>å¦‚æœ root éœ€è¦å¯†ç ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">ansible-playbook playbooks/bootstrap<span class="hljs-selector-class">.yml</span> <span class="hljs-attr">--ask-pass</span><br></code></pre></td></tr></table></figure><p>æˆåŠŸåï¼Œä½ ä¼šçœ‹åˆ°ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">changed</span>=3  <span class="hljs-attribute">failed</span>=0<br></code></pre></td></tr></table></figure><hr><h1 id="å…«ã€ç¬¬-5-æ­¥ï¼šéªŒè¯â€œæ™®é€šç”¨æˆ·å·²ç»è¢«-Ansible-åˆ›å»ºâ€"><a href="#å…«ã€ç¬¬-5-æ­¥ï¼šéªŒè¯â€œæ™®é€šç”¨æˆ·å·²ç»è¢«-Ansible-åˆ›å»ºâ€" class="headerlink" title="å…«ã€ç¬¬ 5 æ­¥ï¼šéªŒè¯â€œæ™®é€šç”¨æˆ·å·²ç»è¢« Ansible åˆ›å»ºâ€"></a>å…«ã€ç¬¬ 5 æ­¥ï¼šéªŒè¯â€œæ™®é€šç”¨æˆ·å·²ç»è¢« Ansible åˆ›å»ºâ€</h1><h3 id="1ï¸âƒ£-æ‰‹åŠ¨-ssh-éªŒè¯ï¼ˆéå¸¸é‡è¦ï¼‰"><a href="#1ï¸âƒ£-æ‰‹åŠ¨-ssh-éªŒè¯ï¼ˆéå¸¸é‡è¦ï¼‰" class="headerlink" title="1ï¸âƒ£ æ‰‹åŠ¨ ssh éªŒè¯ï¼ˆéå¸¸é‡è¦ï¼‰"></a>1ï¸âƒ£ æ‰‹åŠ¨ ssh éªŒè¯ï¼ˆéå¸¸é‡è¦ï¼‰</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">ssh</span> kxllx@<span class="hljs-number">38.95.76.11</span><br></code></pre></td></tr></table></figure><p>èƒ½ç›´æ¥ç™»å½•ã€ä¸è¾“å¯†ç  â†’ âœ…</p><hr><h3 id="2ï¸âƒ£-æµ‹è¯•-sudo"><a href="#2ï¸âƒ£-æµ‹è¯•-sudo" class="headerlink" title="2ï¸âƒ£ æµ‹è¯• sudo"></a>2ï¸âƒ£ æµ‹è¯• sudo</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">whoami</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">root</span><br></code></pre></td></tr></table></figure><p>â†’ âœ…</p><hr><h1 id="ä¹ã€ç¬¬-6-æ­¥ï¼šåˆ‡æ¢åˆ°â€œæ­£å¼è¿ç»´é˜¶æ®µâ€"><a href="#ä¹ã€ç¬¬-6-æ­¥ï¼šåˆ‡æ¢åˆ°â€œæ­£å¼è¿ç»´é˜¶æ®µâ€" class="headerlink" title="ä¹ã€ç¬¬ 6 æ­¥ï¼šåˆ‡æ¢åˆ°â€œæ­£å¼è¿ç»´é˜¶æ®µâ€"></a>ä¹ã€ç¬¬ 6 æ­¥ï¼šåˆ‡æ¢åˆ°â€œæ­£å¼è¿ç»´é˜¶æ®µâ€</h1><p>ç°åœ¨æˆ‘ä»¬<strong>å½»åº•å‘Šåˆ« root</strong>ã€‚</p><h3 id="1ï¸âƒ£-æ™®é€šç”¨æˆ·-inventory"><a href="#1ï¸âƒ£-æ™®é€šç”¨æˆ·-inventory" class="headerlink" title="1ï¸âƒ£ æ™®é€šç”¨æˆ· inventory"></a>1ï¸âƒ£ æ™®é€šç”¨æˆ· inventory</h3><p><code>inventory/hosts_user</code>ï¼š</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[web]</span><br><span class="hljs-number">38.95.76.11</span> ansible_user=kxllx<br></code></pre></td></tr></table></figure><hr><h3 id="2ï¸âƒ£-ä¿®æ”¹-ansible-cfg"><a href="#2ï¸âƒ£-ä¿®æ”¹-ansible-cfg" class="headerlink" title="2ï¸âƒ£ ä¿®æ”¹ ansible.cfg"></a>2ï¸âƒ£ ä¿®æ”¹ ansible.cfg</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[defaults]</span><br><span class="hljs-attr">inventory</span> = inventory/hosts_user<br><span class="hljs-attr">remote_user</span> = kxllx<br></code></pre></td></tr></table></figure><hr><h3 id="3ï¸âƒ£-æµ‹è¯•-Ansibleï¼ˆæ­£å¼æ¨¡å¼ï¼‰"><a href="#3ï¸âƒ£-æµ‹è¯•-Ansibleï¼ˆæ­£å¼æ¨¡å¼ï¼‰" class="headerlink" title="3ï¸âƒ£ æµ‹è¯• Ansibleï¼ˆæ­£å¼æ¨¡å¼ï¼‰"></a>3ï¸âƒ£ æµ‹è¯• Ansibleï¼ˆæ­£å¼æ¨¡å¼ï¼‰</h3><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">ansible web -m <span class="hljs-built_in">ping</span><br></code></pre></td></tr></table></figure><p>æˆåŠŸï¼š</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">pong</span><br></code></pre></td></tr></table></figure><hr><h3 id="4ï¸âƒ£-ææƒæµ‹è¯•"><a href="#4ï¸âƒ£-ææƒæµ‹è¯•" class="headerlink" title="4ï¸âƒ£ ææƒæµ‹è¯•"></a>4ï¸âƒ£ ææƒæµ‹è¯•</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">ansible web -m dnf -<span class="hljs-selector-tag">a</span> <span class="hljs-string">&quot;name=vim state=present&quot;</span> -<span class="hljs-selector-tag">b</span> <span class="hljs-attr">--ask-become-pass</span><br></code></pre></td></tr></table></figure><p>ğŸ‰ <strong>å…¨æµç¨‹é—­ç¯å®Œæˆ</strong></p><hr><h1 id="åã€ä½ ç°åœ¨å·²ç»æŒæ¡çš„â€œé«˜å«é‡‘é‡èƒ½åŠ›â€"><a href="#åã€ä½ ç°åœ¨å·²ç»æŒæ¡çš„â€œé«˜å«é‡‘é‡èƒ½åŠ›â€" class="headerlink" title="åã€ä½ ç°åœ¨å·²ç»æŒæ¡çš„â€œé«˜å«é‡‘é‡èƒ½åŠ›â€"></a>åã€ä½ ç°åœ¨å·²ç»æŒæ¡çš„â€œé«˜å«é‡‘é‡èƒ½åŠ›â€</h1><p>ä½ å·²ç»ä¼šï¼š</p><ul><li>âœ… ç”¨ Ansible ç»™æ–°æœåŠ¡å™¨â€œå¼€è’â€</li><li>âœ… è‡ªåŠ¨åˆ›å»ºæ™®é€šç”¨æˆ·</li><li>âœ… è‡ªåŠ¨é…ç½® SSH key</li><li>âœ… è‡ªåŠ¨é…ç½® sudo</li><li>âœ… ä» root åˆ‡æ¢åˆ°æ™®é€šç”¨æˆ·</li><li>âœ… ç¬¦åˆ RHCE &#x2F; ä¼ä¸šè§„èŒƒ</li></ul>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RHCE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç”¨ role è‡ªåŠ¨åˆ›å»ºç”¨æˆ· + SSH + sudo</title>
    <link href="/2026/01/12/2026.1.12-3/"/>
    <url>/2026/01/12/2026.1.12-3/</url>
    
    <content type="html"><![CDATA[<h4 id="ç›®å½•ç»“æ„"><a href="#ç›®å½•ç»“æ„" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs stylus">.<br>â”œâ”€â”€ ansible<span class="hljs-selector-class">.cfg</span><br>â”œâ”€â”€ inventory<br>â”‚Â Â  â”œâ”€â”€ hosts_root<br>â”‚Â Â  â””â”€â”€ hosts_user<br>â”œâ”€â”€ playbooks<br>â”‚Â Â  â””â”€â”€ users<span class="hljs-selector-class">.yml</span><br>â””â”€â”€ roles<br>â”œâ”€â”€ user_manage<br>     Â Â  â”œâ”€â”€ defaults<br>    Â  Â  â”‚Â Â  â””â”€â”€ <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.yml</span><br>    Â Â   â”œâ”€â”€ files<br>    Â Â   â”‚Â Â  â”œâ”€â”€ id_rsa<br>    Â Â   â”‚Â Â  â””â”€â”€ id_rsa<span class="hljs-selector-class">.pub</span><br>    Â Â   â””â”€â”€ tasks<br>    Â       â””â”€â”€ <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.yml</span><br><br><br></code></pre></td></tr></table></figure><h4 id="playbooks-users-yml"><a href="#playbooks-users-yml" class="headerlink" title="playbooks&#x2F;users.yml"></a>playbooks&#x2F;users.yml</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">---<br> - name: Create admin user<br>   hosts: all     <span class="hljs-comment">###hostså®šä¹‰äº†åœ¨å“ªäº›ä½ä¸»æœºä¸Šæ‰§è¡Œplay,åœ¨æ­¤å¤„æ„å‘³åœ¨ inventory é‡Œå®šä¹‰çš„æ‰€æœ‰ä¸»æœºä¸Š</span><br>   become: <span class="hljs-literal">true</span><br><br>   roles:<br>     - user_manage<br><br></code></pre></td></tr></table></figure><h4 id="defaults-main-ymlï¼ˆå®šä¹‰å˜é‡ï¼‰"><a href="#defaults-main-ymlï¼ˆå®šä¹‰å˜é‡ï¼‰" class="headerlink" title="defaults&#x2F;main.ymlï¼ˆå®šä¹‰å˜é‡ï¼‰"></a>defaults&#x2F;main.ymlï¼ˆå®šä¹‰å˜é‡ï¼‰</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">user_name: test1<br>user_shell: /bin/bash<br>user_groups: wheel<br>user_sudo_nopasswd: <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><h4 id="tasks-mian-yml"><a href="#tasks-mian-yml" class="headerlink" title="tasks&#x2F;mian.yml"></a>tasks&#x2F;mian.yml</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">---<br> - name: Create normal user<br>   ansible.builtin.user:<br>     name: <span class="hljs-string">&quot;&#123;&#123; user_name &#125;&#125;&quot;</span><br>     shell: <span class="hljs-string">&quot;&#123;&#123; user_shell &#125;&#125;&quot;</span><br>     <span class="hljs-built_in">groups</span>: <span class="hljs-string">&quot;&#123;&#123; user_groups &#125;&#125;&quot;</span><br>     append: <span class="hljs-built_in">yes</span>   <span class="hljs-comment">###appendçš„ç”¨å¤„ï¼šåœ¨ä¿ç•™åŸæœ‰é™„åŠ ç»„çš„å‰æä¸‹ï¼ŒæŠŠç”¨æˆ·åŠ å…¥åˆ°æŒ‡å®šçš„ groups</span><br>     state: present<br><br> - name: Create .shh directory<br>   ansible.builtin.file:<br>     path: <span class="hljs-string">&quot;/home/&#123;&#123; user_name &#125;&#125;/.shh&quot;</span><br>     state: directory<br>     owner: <span class="hljs-string">&quot;&#123;&#123; user_name &#125;&#125;&quot;</span><br>     group: <span class="hljs-string">&quot;&#123;&#123; user_name &#125;&#125;&quot;</span><br>     mode: <span class="hljs-string">&#x27;0700&#x27;</span><br><br> - name: Install authorized key<br>   ansible.builtin.authorized_key:   <span class="hljs-comment">###åœ¨æ§åˆ¶æœºä¸Šè¯»å–è¿™ä¸ªå…¬é’¥æ–‡ä»¶å†…å®¹ï¼ŒæŒ‡å®šè¿™ä¸ªå…¬é’¥å±äºå“ªä¸ªç”¨æˆ·</span><br>     user: <span class="hljs-string">&quot;&#123;&#123; user_name &#125;&#125;&quot;</span>         <span class="hljs-comment">###åœ¨è¢«æ§æœºå†™å…¥/home/test1/.ssh/authorized_keys</span><br>     key: <span class="hljs-string">&quot;&#123;&#123; lookup(&#x27;file&#x27;,&#x27;/root/.ssh/id_rsa.pub&#x27;) &#125;&#125;&quot;</span><br><br> - name: Allow user <span class="hljs-built_in">sudo</span> without password<br>   ansible.builtin.copy:<span class="hljs-comment">###åœ¨ç›®æ ‡ä¸»æœºdestè·¯å¾„æ–‡ä»¶ä¸­æ·»åŠ contentå†…å®¹</span><br>     dest: <span class="hljs-string">&quot;/etc/sudoers.d/&#123;&#123; user_name &#125;&#125;&quot;</span><br>     content: <span class="hljs-string">&quot;&#123;&#123; user_name &#125;&#125; ALL=(ALL) NOPASSWD: ALL\n&quot;</span><br>     owner: root<br>     group: root<br>     mode: <span class="hljs-string">&#x27;0440&#x27;</span><span class="hljs-comment">### -r--r-----  root root  /etc/sudoers.d/deploy</span><br>   when: user_sudo_nopasswd<span class="hljs-comment">###user_sudo_nopasswd:trueåˆ™æ‰§è¡Œï¼Œflaseåˆ™è·³è¿‡è¿™ä¸€æ­¥</span><br></code></pre></td></tr></table></figure><h4 id="ansible-cfg"><a href="#ansible-cfg" class="headerlink" title="ansible.cfg"></a>ansible.cfg</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">[defaults]<br>inventory = inventory<br>roles_path = roles<br>remote_user = kxllx<br>host_key_checking = False      <span class="hljs-comment">###å…³é—­ SSH ä¸»æœºæŒ‡çº¹æ ¡éªŒï¼Œé¿å… Ansible åœ¨ç¬¬ä¸€æ¬¡è¿æ¥ä¸»æœºæ—¶å¡ä½æˆ–å¤±è´¥</span><br></code></pre></td></tr></table></figure><h4 id="inventory-hosts-user"><a href="#inventory-hosts-user" class="headerlink" title="inventory&#x2F;hosts_user"></a>inventory&#x2F;hosts_user</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[web]<br>38.95.76.11<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RHCE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>nginx-role</title>
    <link href="/2026/01/12/2026.1.12-4/"/>
    <url>/2026/01/12/2026.1.12-4/</url>
    
    <content type="html"><![CDATA[<h4 id="ç›®å½•ç»“æ„"><a href="#ç›®å½•ç»“æ„" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">roles/<br>â””â”€â”€ nginx/<br>    â”œâ”€â”€ defaults/<br>    â”‚   â””â”€â”€ main.yml<br>    â”œâ”€â”€ tasks/<br>    â”‚   â””â”€â”€ main.yml<br>    â”œâ”€â”€ handlers/<br>    â”‚   â””â”€â”€ main.yml<br>    â””â”€â”€ templates/<br>        â””â”€â”€ nginx.conf.j2<br></code></pre></td></tr></table></figure><h4 id="defaults-main-yml"><a href="#defaults-main-yml" class="headerlink" title="defaults&#x2F;main.yml"></a>defaults&#x2F;main.yml</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">nginx_package: nginx<br>nginx_service: nginx<br><br>nginx_listen_port: 80<br>nginx_root: /usr/share/nginx/html<br></code></pre></td></tr></table></figure><h4 id="tsak-main-yml"><a href="#tsak-main-yml" class="headerlink" title="tsak&#x2F;main.yml"></a>tsak&#x2F;main.yml</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">- name: Install nginx<br>  ansible.builtin.package:<br>  name: â€œ&#123;&#123; nginx_package &#125;&#125;â€<br>  state: present<br>  <br>- name: Deploy nginx config<br>  ansible.builtin.template:<br>  src: nginx.conf.j2<br>    dest: /etc/nginx/nginx.conf<br>    owner: root<br>    group: root<br>    mode: <span class="hljs-string">&#x27;0644&#x27;</span><br>  notify: Restart nginx<br> <br>- name: Enable and start nginx<br>  ansible.builtin.service:<br>    name: <span class="hljs-string">&quot;&#123;&#123; nginx_service &#125;&#125;&quot;</span><br>    state: started<br>    <span class="hljs-built_in">enable</span>: <span class="hljs-built_in">yes</span><br></code></pre></td></tr></table></figure><h4 id="handlers-main-yml"><a href="#handlers-main-yml" class="headerlink" title="handlers&#x2F;main.yml"></a>handlers&#x2F;main.yml</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">---<br> - name: Restart nginx<br>   ansible.builtin.service:<br>     name: <span class="hljs-string">&quot;&#123;&#123; nginx_service &#125;&#125;&quot;</span><br>     satte: restarted<br></code></pre></td></tr></table></figure><h4 id="templates-nginx-conf-j2"><a href="#templates-nginx-conf-j2" class="headerlink" title="templates&#x2F;nginx.conf.j2"></a>templates&#x2F;nginx.conf.j2</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">events &#123;&#125;<br><br>http &#123;<br>server&#123;<br>listen &#123;&#123; nginx_listen_port &#125;&#125;;<br>location /&#123;<br>root &#123;&#123; nginx_root &#125;&#125;;<br>index index.html;<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="playbook-nginx-yml"><a href="#playbook-nginx-yml" class="headerlink" title="playbook&#x2F;nginx.yml"></a>playbook&#x2F;nginx.yml</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">- name: Configure nginx<br>  host: web<br>  become: <span class="hljs-literal">true</span><br>  roles:<br>    - nginx<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RHCE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>nginx-roleï¼ˆè€ƒè¯•æœ€ç®€ç‰ˆæœ¬ï¼‰</title>
    <link href="/2026/01/12/2026.1.12-5/"/>
    <url>/2026/01/12/2026.1.12-5/</url>
    
    <content type="html"><![CDATA[<h4 id="ç›®å½•ç»“æ„"><a href="#ç›®å½•ç»“æ„" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs stylus">.<br>â”œâ”€â”€ ansible<span class="hljs-selector-class">.cfg</span><br>â”œâ”€â”€ inventory<br>â”‚Â Â  â”œâ”€â”€ hosts_root<br>â”‚Â Â  â””â”€â”€ hosts_user<br>â”œâ”€â”€ playbooks<br>â”‚Â Â  â”œâ”€â”€ nginx<span class="hljs-selector-class">.yml</span><br>â””â”€â”€ roles<br>    â”œâ”€â”€ nginx<br>    Â Â   â”œâ”€â”€ defaults<br>    Â Â   â”‚Â Â  â””â”€â”€ <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.yml</span><br>    Â Â   â”œâ”€â”€ handlers<br>    Â Â   â”‚Â Â  â””â”€â”€ <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.yml</span><br>    Â Â   â”œâ”€â”€ tasks<br>    Â Â   â”‚Â Â  â”œâ”€â”€ config<span class="hljs-selector-class">.yml</span><br>    Â Â   â”‚Â Â  â”œâ”€â”€ install<span class="hljs-selector-class">.yml</span><br>    Â Â   â”‚Â Â  â”œâ”€â”€ <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.yml</span><br>    Â Â   â”‚Â Â  â””â”€â”€ service<span class="hljs-selector-class">.yml</span><br>    Â Â   â””â”€â”€ templates<br>    Â Â       â””â”€â”€ nginx<span class="hljs-selector-class">.conf</span><span class="hljs-selector-class">.j2</span><br><br></code></pre></td></tr></table></figure><h4 id="playbooks-nginx-yml"><a href="#playbooks-nginx-yml" class="headerlink" title="playbooks&#x2F;nginx.yml"></a>playbooks&#x2F;nginx.yml</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">- name: Install and start nginx<br>  hosts: web<br>  become: <span class="hljs-built_in">yes</span><br><br>  roles:<br>    - nginx<br></code></pre></td></tr></table></figure><h4 id="defaults-main-yml"><a href="#defaults-main-yml" class="headerlink" title="defaults&#x2F;main.yml"></a>defaults&#x2F;main.yml</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">---<br>nginx_package: nginx<br>nginx_service: nginx<br><br>nginx_listen_port: 80<br>nginx_server_name: localhost<br><br>nginx_root: /usr/share/nginx/html<br>nginx_conf_path: /etc/nginx/nginx.conf<br></code></pre></td></tr></table></figure><h4 id="tasks"><a href="#tasks" class="headerlink" title="tasks&#x2F;"></a>tasks&#x2F;</h4><h5 id="main-yml"><a href="#main-yml" class="headerlink" title="main.yml"></a>main.yml</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">- import_tasks: install.yml<br>- import_tasks: config.yml<br>- import_tasks: service.yml<br></code></pre></td></tr></table></figure><h5 id="install-yml"><a href="#install-yml" class="headerlink" title="install.yml"></a>install.yml</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">---<br>- name: Install nginx<br>  ansible.builtin.package:<br>    name: <span class="hljs-string">&quot;&#123;&#123; nginx_package &#125;&#125;&quot;</span><br>    state: present<br></code></pre></td></tr></table></figure><h5 id="config-yml"><a href="#config-yml" class="headerlink" title="config.yml"></a>config.yml</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">---<br>- name: Deploy nginx main configuration<br>  ansible.builtin.template:     <span class="hljs-comment">###æŠŠæ¨¡æ¿æ¸²æŸ“æˆçœŸå®çš„nginx.conf</span><br>    src: nginx.conf.j2<br>    dest: <span class="hljs-string">&quot;&#123;&#123; nginx_conf_path &#125;&#125;&quot;</span><span class="hljs-comment">###æ”¾åˆ°è¢«æ§æœºçš„æŒ‡å®šè·¯å¾„</span><br>    owner: root<br>    group: root<br>    mode: <span class="hljs-string">&#x27;0644&#x27;</span><br>  notify: Restart nginx<span class="hljs-comment">###å¦‚æœå†…å®¹å˜äº†ï¼Œæ‰§è¡Œhandleré‡å¯nginx</span><br></code></pre></td></tr></table></figure><h5 id="service-yml"><a href="#service-yml" class="headerlink" title="service.yml"></a>service.yml</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">---<br>- name: Enable and start nginx<br>  ansible.builtin.service:<br>    name: <span class="hljs-string">&quot;&#123;&#123; nginx_service &#125;&#125;&quot;</span><br>    state: started<br>    enabled: <span class="hljs-built_in">yes</span><br></code></pre></td></tr></table></figure><h4 id="handlers-main-yml"><a href="#handlers-main-yml" class="headerlink" title="handlers&#x2F;main.yml"></a>handlers&#x2F;main.yml</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">---<br>- name: Restart nginx<br>  ansible.builtin.service:<br>    name: <span class="hljs-string">&quot;&#123;&#123; nginx_service &#125;&#125;&quot;</span><br>    state: restarted<br></code></pre></td></tr></table></figure><h4 id="templates-nginx-conf-j2"><a href="#templates-nginx-conf-j2" class="headerlink" title="templates&#x2F;nginx.conf.j2"></a>templates&#x2F;nginx.conf.j2</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">user nginx;<br>worker_processes auto;<br><br>events &#123;&#125;<br><br>http &#123;<br>    server &#123;<br>        listen &#123;&#123; nginx_listen_port &#125;&#125;;<br>        location / &#123;<br>            root &#123;&#123; nginx_root &#125;&#125;;<br>            index index.html;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RHCE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>firewallæŸ¥çœ‹å£è¯€</title>
    <link href="/2026/01/12/2026.1.12-6/"/>
    <url>/2026/01/12/2026.1.12-6/</url>
    
    <content type="html"><![CDATA[<h4 id="ä¸€ã€æœåŠ¡æ´»æ²¡æ´»"><a href="#ä¸€ã€æœåŠ¡æ´»æ²¡æ´»" class="headerlink" title="ä¸€ã€æœåŠ¡æ´»æ²¡æ´»"></a>ä¸€ã€æœåŠ¡æ´»æ²¡æ´»</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">systemctl status firewalld<br></code></pre></td></tr></table></figure><h4 id="äºŒã€ç”¨äº†å“ªä¸ªåŒº"><a href="#äºŒã€ç”¨äº†å“ªä¸ªåŒº" class="headerlink" title="äºŒã€ç”¨äº†å“ªä¸ªåŒº"></a>äºŒã€ç”¨äº†å“ªä¸ªåŒº</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">firewall-cmd --get-active-zone<br></code></pre></td></tr></table></figure><h4 id="ä¸‰ã€ä¸‰æ¿æ–§"><a href="#ä¸‰ã€ä¸‰æ¿æ–§" class="headerlink" title="ä¸‰ã€ä¸‰æ¿æ–§"></a>ä¸‰ã€ä¸‰æ¿æ–§</h4><h5 id="çœ‹ç«¯å£"><a href="#çœ‹ç«¯å£" class="headerlink" title="çœ‹ç«¯å£"></a>çœ‹ç«¯å£</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">firewall-cmd --zone=public --list-ports<br></code></pre></td></tr></table></figure><h5 id="çœ‹æœåŠ¡"><a href="#çœ‹æœåŠ¡" class="headerlink" title="çœ‹æœåŠ¡"></a>çœ‹æœåŠ¡</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">firewall-cmd --zone=pubilc --list-sevices<br></code></pre></td></tr></table></figure><h5 id="å…¨éƒ¨çœ‹"><a href="#å…¨éƒ¨çœ‹" class="headerlink" title="å…¨éƒ¨çœ‹"></a>å…¨éƒ¨çœ‹</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">firewall-cmd --zone=public --list-all<br></code></pre></td></tr></table></figure><h4 id="å››ã€é»˜è®¤åŒº"><a href="#å››ã€é»˜è®¤åŒº" class="headerlink" title="å››ã€é»˜è®¤åŒº"></a>å››ã€é»˜è®¤åŒº</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">firewall-cmd --get-default-zone<br></code></pre></td></tr></table></figure><h4 id="äº”ã€è¿è¡Œç”Ÿæ•ˆä¸æ°¸ä¹…ç”Ÿæ•ˆ"><a href="#äº”ã€è¿è¡Œç”Ÿæ•ˆä¸æ°¸ä¹…ç”Ÿæ•ˆ" class="headerlink" title="äº”ã€è¿è¡Œç”Ÿæ•ˆä¸æ°¸ä¹…ç”Ÿæ•ˆ"></a>äº”ã€è¿è¡Œç”Ÿæ•ˆä¸æ°¸ä¹…ç”Ÿæ•ˆ</h4><h5 id="çœ‹æ°¸ä¹…è§„åˆ™"><a href="#çœ‹æ°¸ä¹…è§„åˆ™" class="headerlink" title="çœ‹æ°¸ä¹…è§„åˆ™"></a>çœ‹æ°¸ä¹…è§„åˆ™</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">firewall-cmd --zone=public --list-ports --permanent<br></code></pre></td></tr></table></figure><h5 id="çœ‹å½“å‰ç”Ÿæ•ˆ"><a href="#çœ‹å½“å‰ç”Ÿæ•ˆ" class="headerlink" title="çœ‹å½“å‰ç”Ÿæ•ˆ"></a>çœ‹å½“å‰ç”Ÿæ•ˆ</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">firewall-cmd --zone=public --list-ports<br></code></pre></td></tr></table></figure><h4 id="å…­ã€è§„åˆ™åŠ äº†-â‰ -èƒ½è®¿é—®"><a href="#å…­ã€è§„åˆ™åŠ äº†-â‰ -èƒ½è®¿é—®" class="headerlink" title="å…­ã€è§„åˆ™åŠ äº† â‰  èƒ½è®¿é—®"></a>å…­ã€è§„åˆ™åŠ äº† â‰  èƒ½è®¿é—®</h4><h5 id="é˜²ç«å¢™"><a href="#é˜²ç«å¢™" class="headerlink" title="é˜²ç«å¢™"></a>é˜²ç«å¢™</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">firewall-cmd --list-all<br></code></pre></td></tr></table></figure><h5 id="æœåŠ¡ç›‘å¬"><a href="#æœåŠ¡ç›‘å¬" class="headerlink" title="æœåŠ¡ç›‘å¬"></a>æœåŠ¡ç›‘å¬</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ss -lntp | grep ç«¯å£<br></code></pre></td></tr></table></figure><p><strong>å£è¯€ï¼š</strong></p><p>é˜²ç«å¢™åªç®¡æ”¾<br>æœåŠ¡ä¸å¬ç™½å¿™</p><h4 id="ä¸ƒã€æ¥å£ç»‘å®šï¼ˆé«˜çº§ä½†å¸¸è€ƒï¼‰"><a href="#ä¸ƒã€æ¥å£ç»‘å®šï¼ˆé«˜çº§ä½†å¸¸è€ƒï¼‰" class="headerlink" title="ä¸ƒã€æ¥å£ç»‘å®šï¼ˆé«˜çº§ä½†å¸¸è€ƒï¼‰"></a>ä¸ƒã€æ¥å£ç»‘å®šï¼ˆé«˜çº§ä½†å¸¸è€ƒï¼‰</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">firewall-cmd --zone=public --list-interfaces<br></code></pre></td></tr></table></figure><h4 id="å…«ã€å®æˆ˜é€ŸæŸ¥â€œä¸€å£æ°”æµç¨‹â€ï¼ˆå¼ºçƒˆå»ºè®®èƒŒï¼‰"><a href="#å…«ã€å®æˆ˜é€ŸæŸ¥â€œä¸€å£æ°”æµç¨‹â€ï¼ˆå¼ºçƒˆå»ºè®®èƒŒï¼‰" class="headerlink" title="å…«ã€å®æˆ˜é€ŸæŸ¥â€œä¸€å£æ°”æµç¨‹â€ï¼ˆå¼ºçƒˆå»ºè®®èƒŒï¼‰"></a>å…«ã€å®æˆ˜é€ŸæŸ¥â€œä¸€å£æ°”æµç¨‹â€ï¼ˆå¼ºçƒˆå»ºè®®èƒŒï¼‰</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">systemctl status firewalld<br>firewall-cmd --get-active-zones<br>firewall-cmd --zone=public --list-all<br>ss -lntp<br></code></pre></td></tr></table></figure><h4 id="ä¹ã€iptables-åœºæ™¯ï¼ˆè€é¢˜-å…¼å®¹é¢˜ï¼‰"><a href="#ä¹ã€iptables-åœºæ™¯ï¼ˆè€é¢˜-å…¼å®¹é¢˜ï¼‰" class="headerlink" title="ä¹ã€iptables åœºæ™¯ï¼ˆè€é¢˜&#x2F;å…¼å®¹é¢˜ï¼‰"></a>ä¹ã€iptables åœºæ™¯ï¼ˆè€é¢˜&#x2F;å…¼å®¹é¢˜ï¼‰</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">iptables -L -n<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RHCE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cockpitç®¡ç†ç«™æ­å»º</title>
    <link href="/2025/01/08/2025.1.8-1/"/>
    <url>/2025/01/08/2025.1.8-1/</url>
    
    <content type="html"><![CDATA[<p>Cockpit æ˜¯ä¸€ä¸ªç”¨äºç®¡ç† Linux æœåŠ¡å™¨çš„ç®€æ´è€Œå¼ºå¤§çš„å›¾å½¢åŒ–å·¥å…·ã€‚å®ƒå…è®¸ç³»ç»Ÿç®¡ç†å‘˜é€šè¿‡ä¸€ä¸ª Web ç•Œé¢æ‰§è¡Œå„ç§ç³»ç»Ÿç®¡ç†ä»»åŠ¡ï¼Œè€Œæ— éœ€åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥å¤æ‚çš„å‘½ä»¤ã€‚Cockpit æ”¯æŒå„ç§æ“ä½œç³»ç»Ÿå’Œ Linux å‘è¡Œç‰ˆï¼Œå¦‚ Fedoraã€RHELã€CentOSã€Debian å’Œ Ubuntuã€‚</p><p>Cockpit çš„ä¸»è¦ç”¨é€”ï¼š</p><ul><li>ç³»ç»Ÿç›‘æ§ï¼šå®æ—¶æŸ¥çœ‹ CPUã€å†…å­˜ã€ç½‘ç»œå’Œå­˜å‚¨ä½¿ç”¨æƒ…å†µã€‚</li><li>æ—¥å¿—æŸ¥çœ‹ï¼šè®¿é—®ç³»ç»Ÿæ—¥å¿—ä»¥è¯Šæ–­å’Œæ’é™¤é—®é¢˜ã€‚</li><li>æœåŠ¡ç®¡ç†ï¼šå¯åŠ¨ã€åœæ­¢å’Œé‡å¯ç³»ç»ŸæœåŠ¡ã€‚</li><li>ç½‘ç»œé…ç½®ï¼šç®¡ç†ç½‘ç»œæ¥å£ã€æŸ¥çœ‹ç½‘ç»œè¿æ¥å’Œé…ç½®é˜²ç«å¢™ã€‚</li><li>å­˜å‚¨ç®¡ç†ï¼šç®¡ç†ç¡¬ç›˜ã€åˆ†åŒºå’Œæ–‡ä»¶ç³»ç»Ÿã€‚</li><li>ç”¨æˆ·ç®¡ç†ï¼šæ·»åŠ ã€åˆ é™¤å’Œä¿®æ”¹ç³»ç»Ÿç”¨æˆ·å’Œç»„ã€‚</li><li>è½¯ä»¶æ›´æ–°ï¼šå®‰è£…å’Œæ›´æ–°ç³»ç»Ÿè½¯ä»¶åŒ…ã€‚</li><li>å®¹å™¨ç®¡ç†ï¼šæ”¯æŒç®¡ç† Docker å’Œ Podman å®¹å™¨ã€‚</li></ul><hr><p>é¡¹ç›®ä¸»é¡µï¼š<a href="https://cockpit-project.org/">https://cockpit-project.org/</a></p><p>æœ€ç»ˆæ•ˆæœå±•ç¤ºï¼š<a href="https://cockpit.cjh.zone/">https://cockpit.cjh.zone</a></p><hr><h4 id="1-å®‰è£…ä¸æ›´æ–°"><a href="#1-å®‰è£…ä¸æ›´æ–°" class="headerlink" title="1.å®‰è£…ä¸æ›´æ–°"></a>1.å®‰è£…ä¸æ›´æ–°</h4><p>å®‰è£…cockpit:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt install cockpit -y<br></code></pre></td></tr></table></figure><p>å¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">systemctl <span class="hljs-built_in">enable</span> cockpit.socket<br>systemctl start cockpit.socket<br></code></pre></td></tr></table></figure><p>ç»è¿‡ä¸Šé¢çš„æ­¥éª¤ï¼ŒCockpit åº”è¯¥å·²ç»åœ¨ <code>9090</code> ç«¯å£å¯åŠ¨äº†ï¼Œå¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—® <code>https://your-server-ip:9090</code>ï¼‰ã€‚ç°åœ¨çš„ ssl è¯ä¹¦æ˜¯ Cockpit è‡ªç­¾çš„ï¼Œæµè§ˆå™¨ä¼šæç¤ºä¸å®‰å…¨ï¼Œå¯ä»¥é€‰æ‹©ç»§ç»­è®¿é—®</p><p>ockpit é»˜è®¤ç¦æ­¢äº† <code>root</code> ç”¨æˆ·ç™»å½•,å¯ä»¥ä¿®æ”¹ <code>/etc/cockpit/disallowed-users</code> ä¸­çš„é…ç½®</p><p>é»˜è®¤é…ç½®æ˜¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># List of users which are not allowed to login to Cockpit</span><br>root  <span class="hljs-comment"># é»˜è®¤ç¦æ­¢äº† root ç”¨æˆ·ç™»å½•</span><br></code></pre></td></tr></table></figure><h4 id="2-webæœåŠ¡é…ç½®"><a href="#2-webæœåŠ¡é…ç½®" class="headerlink" title="2.webæœåŠ¡é…ç½®"></a>2.webæœåŠ¡é…ç½®</h4><h5 id="2-1-ä¿®æ”¹Cockpit-é»˜è®¤ç›‘å¬"><a href="#2-1-ä¿®æ”¹Cockpit-é»˜è®¤ç›‘å¬" class="headerlink" title="2-1.ä¿®æ”¹Cockpit é»˜è®¤ç›‘å¬"></a>2-1.ä¿®æ”¹Cockpit é»˜è®¤ç›‘å¬</h5><p>Cockpit é»˜è®¤ç›‘å¬çš„æ˜¯ <code>0.0.0.0:9090</code>ï¼Œå°†å…¶æ”¹ä¸º <code>127.0.0.1:9090</code></p><p>åœ¨é…ç½®æ–‡ä»¶ <code>/etc/systemd/system/cockpit.socket.d/listen.conf</code> ä¸­åŠ å…¥ä»¥ä¸‹å†…å®¹ï¼ˆå¯èƒ½éœ€è¦åˆ›å»ºä¸€ä¸‹ç›®å½•å’Œæ–‡ä»¶ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[Socket]<br>ListenStream=<br>ListenStream=127.0.0.1:9090<br>FreeBind=<span class="hljs-built_in">yes</span><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€è¡Œ <code>ListenStream=</code> æ˜¯æ¸…ç©ºé»˜è®¤çš„ç›‘å¬åœ°å€ï¼Œç¬¬äºŒè¡Œ <code>ListenStream=127.0.0.1:9090</code> æ˜¯é‡æ–°æŒ‡å®šç›‘å¬åœ°å€ã€‚</p><p>é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶å¹¶é‡å¯æœåŠ¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">systemctl daemon-reload<br>systemctl restart cockpit.socket<br></code></pre></td></tr></table></figure><h5 id="2-2-Cockpit-åå‘ä»£ç†é…ç½®"><a href="#2-2-Cockpit-åå‘ä»£ç†é…ç½®" class="headerlink" title="2-2.Cockpit åå‘ä»£ç†é…ç½®"></a>2-2.Cockpit åå‘ä»£ç†é…ç½®</h5><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œç”±äº<a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">è·¨åŸŸé™åˆ¶</a>ï¼ŒCockpit ä¸èƒ½è¢«å…¶ä»–åŸŸåè®¿é—®ï¼Œå› æ­¤éœ€è¦åœ¨é…ç½®æ–‡ä»¶ <code>/etc/cockpit/cockpit.conf</code> ä¸­åŠ å…¥ä»¥ä¸‹å†…å®¹ï¼ˆæ–‡ä»¶ä¸å­˜åœ¨å°±åˆ›å»ºä¸€ä¸‹ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[WebService]<br> Origins = https://cockpit.domain.tld wss://cockpit.domain.tld<br> ProtocolHeader = X-Forwarded-Proto<br></code></pre></td></tr></table></figure><h5 id="2-3-nginx-åå‘ä»£ç†é…ç½®"><a href="#2-3-nginx-åå‘ä»£ç†é…ç½®" class="headerlink" title="2-3.nginx åå‘ä»£ç†é…ç½®"></a>2-3.nginx åå‘ä»£ç†é…ç½®</h5><p>åœ¨<code>/etc/nginx/conf.d/cockpit.conf</code>ä¸­æ·»åŠ ï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>       <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl;<br>       <span class="hljs-attribute">server_name</span> cockpit.domain.tld;<br><br>       <span class="hljs-attribute">ssl_certificate</span> /etc/letsencrypt/live/cockpit.domain.tld/fullchain.pem; <span class="hljs-comment"># managed by Certbot</span><br>       <span class="hljs-attribute">ssl_certificate_key</span> /etc/letsencrypt/live/cockpit.domain.tld/privkey.pem; <span class="hljs-comment"># managed by Certbot</span><br>       <span class="hljs-attribute">include</span> /etc/letsencrypt/options-ssl-nginx.conf;<br>       <span class="hljs-attribute">ssl_dhparam</span> /etc/letsencrypt/ssl-dhparams.pem;<br><br>         <span class="hljs-section">location</span> / &#123;<br>           <span class="hljs-comment"># ä½¿ç”¨ HTTP è¿æ¥åˆ° Cockpit æœåŠ¡</span><br>           <span class="hljs-attribute">proxy_pass</span> http://127.0.0.1:9090/;<br>           <span class="hljs-attribute">proxy_set_header</span> Host <span class="hljs-variable">$host</span>;<br>           <span class="hljs-attribute">proxy_set_header</span> X-Real-IP <span class="hljs-variable">$remote_addr</span>;<br>           <span class="hljs-attribute">proxy_set_header</span> X-Forwarded-For <span class="hljs-variable">$proxy_add_x_forwarded_for</span>;<br>           <span class="hljs-attribute">proxy_set_header</span> X-Forwarded-Proto <span class="hljs-variable">$scheme</span>;<br><br>           <span class="hljs-comment"># æ”¯æŒ WebSocket</span><br>           <span class="hljs-attribute">proxy_http_version</span> <span class="hljs-number">1</span>.<span class="hljs-number">1</span>;<br>           <span class="hljs-attribute">proxy_set_header</span> Upgrade <span class="hljs-variable">$http_upgrade</span>;<br>           <span class="hljs-attribute">proxy_set_header</span> Connection <span class="hljs-string">&quot;upgrade&quot;</span>;<br>           <span class="hljs-attribute">proxy_buffering</span> <span class="hljs-literal">off</span>;<br>           <span class="hljs-attribute">proxy_read_timeout</span> <span class="hljs-number">3600</span>;<br>       &#125;<br>     &#125;<br></code></pre></td></tr></table></figure><p>é‡å¯ nginx æœåŠ¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">systemctl restart nginx<br></code></pre></td></tr></table></figure><h4 id="3-æ·»åŠ å…¶ä»–æœºå™¨"><a href="#3-æ·»åŠ å…¶ä»–æœºå™¨" class="headerlink" title="3.æ·»åŠ å…¶ä»–æœºå™¨"></a>3.æ·»åŠ å…¶ä»–æœºå™¨</h4><p>å…¶ä»–æœºå™¨ä¹Ÿéœ€è¦åƒå‰é¢çš„æ­¥éª¤å®‰è£… Cockpitï¼Œ<strong>ä½†æ˜¯ä¸éœ€è¦å†è¿›è¡Œ Web æœåŠ¡é…ç½®äº†</strong>ã€‚</p><p>å®‰è£…å¥½ Cockpit åï¼Œå¯ä»¥åœ¨ Web ç•Œé¢çš„å·¦ä¾§å¯¼èˆªæ ä¸­æ‰¾åˆ° <code>Add Server</code>ï¼Œç‚¹å‡»åè¾“å…¥å…¶ä»–æœºå™¨çš„ IP åœ°å€å’Œç”¨æˆ·åå¯†ç å³å¯æ·»åŠ ã€‚</p><img src="https://chev.kxllx.uk/images/2025/01/08/f51d0eeed527dba598abf5daebe0.png" alt="img" style="zoom:33%;" /><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½ çš„æœºå™¨çš„ <code>ssh</code> ç«¯å£ä¸æ˜¯é»˜è®¤çš„ <code>22</code>ï¼Œå¯ä»¥åœ¨æ·»åŠ æœºå™¨æ—¶åœ¨ IP åœ°å€ååŠ ä¸Šç«¯å£å·ï¼Œä¾‹å¦‚ <code>192.168.1.1:2222</code>ã€‚</p><hr><h3 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h3><p><a href="https://www.cjh.zone/blog/cockpit/">Cockpit å®‰è£…é…ç½®æ•™ç¨‹ | Jianhu Chen</a></p><p><a href="https://cockpit-project.org/running.html#debian">https://cockpit-project.org/running.html#debian</a></p>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸŸåå˜æ›´</title>
    <link href="/2024/12/24/2024.12.24-1/"/>
    <url>/2024/12/24/2024.12.24-1/</url>
    
    <content type="html"><![CDATA[<p>é™•è¥¿å‡ºå·®äº†ä¸€æ®µæ—¶é—´ï¼Œå›æ¥å‘ç°åŸæ¥çš„kxllx.shopåŸŸåè¿‡æœŸäº†ï¼Œä¹‹å‰æ˜¯åœ¨namesiloç«™ä¹°çš„ï¼Œæˆ‘è®°å¾—åŸæ¥åªè¦5åˆ€å·¦å³ï¼Œç°åœ¨å›å»ç»­è´¹ï¼Œå¥½å®¶ä¼™ç›´æ¥ä¸€å¹´20å¤šåˆ€ï¼Œé’±åŒ…è¿˜æ˜¯æ¯”è¾ƒè–„ï¼Œè¿˜æ˜¯å†³å®šæ¢ä¸€ä¸‹åŸŸåï¼Œåœ¨cloudfareä¸‹ä¹°äº†ä¸ªä¾¿å®œçš„åŸŸåï¼Œä¹‹åkxllxä¸‹çš„ç«™ç‚¹éƒ½è¿ç§»åˆ°kxllx.ukè¿™ä¸ªåŸŸåä¸‹</p>]]></content>
    
    
    <categories>
      
      <category>å‡æ»æ—¶é—´</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚è¯´</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>kxllxçš„ç¾éš¾</title>
    <link href="/2024/10/23/2024.10.23-1/"/>
    <url>/2024/10/23/2024.10.23-1/</url>
    
    <content type="html"><![CDATA[<p>ç”±äºå‡ºäº†ä¸€ä¸ªæœˆçš„å·®ï¼Œå¿˜è®°ç»­è´¹åœ¨vmissä¸Šè´­ä¹°çš„ä¸»æœåŠ¡å™¨ï¼Œå¯¼è‡´æ‰€æœ‰çš„ç½‘ç«™ï¼ŒåŒ…æ‹¬åšå®¢ã€å›¾ä¼ ã€é€šè®¯ç«™ç­‰å…¨éƒ¨ä¸¢å¤±ã€‚ã€‚ã€‚</p><p>èµ·åˆååˆ†çš„å´©æºƒï¼Œåæ¥æƒ³æƒ³ï¼Œå¤§ä¸äº†é‡æ–°å»ºä¸€éç®—äº†</p><p>è¿˜å¥½blogæ–‡ä»¶ç•™æœ‰å¤‡ä»½ï¼Œchevå›¾åºŠæ–‡ä»¶åœ¨åŸå°é¸¡ä¸Šè¿˜æœ‰éƒ¨åˆ†ç•™å­˜ï¼Œå”‰ï¼Œä¸‹æ¬¡è®°å¾—ç»­è´¹ã€‚ã€‚ã€‚ã€‚ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å‡æ»æ—¶é—´</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ—¥è®°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å»ºç«‹keneræ¢é’ˆç«™</title>
    <link href="/2024/09/11/2024.9.11-1/"/>
    <url>/2024/09/11/2024.9.11-1/</url>
    
    <content type="html"><![CDATA[<p>å»ºç«‹keneræ¢é’ˆç«™ï¼Œå› ä¸ºçœŸçš„é—²å¾—æ— èŠ</p><hr><h4 id="keneræ¢é’ˆ"><a href="#keneræ¢é’ˆ" class="headerlink" title="keneræ¢é’ˆ"></a>keneræ¢é’ˆ</h4><p>Kener æ¢é’ˆæ˜¯ä¸€æ¬¾ç½‘ç»œç›‘æ§å’Œæ€§èƒ½ç›‘æµ‹å·¥å…·ï¼Œå®ƒä¸»è¦ç”¨äºå®æ—¶ç›‘æ§å„ç§ç½‘ç»œæœåŠ¡çš„å¯ç”¨æ€§ã€æ€§èƒ½å’Œè¿è¡ŒçŠ¶æ€ã€‚é€šè¿‡éƒ¨ç½² Kener æ¢é’ˆï¼Œå¯ä»¥å¸®åŠ©ä½ ç›‘æ§ç½‘ç«™ã€API æ¥å£æˆ–å…¶ä»–ç½‘ç»œæœåŠ¡çš„çŠ¶æ€ï¼Œä»¥ç¡®ä¿å®ƒä»¬èƒ½å¤Ÿæ­£å¸¸è¿è¡Œï¼Œå¹¶åœ¨æœåŠ¡ä¸­æ–­æˆ–æ€§èƒ½ä¸‹é™æ—¶åŠæ—¶æŠ¥è­¦ã€‚</p><hr><h4 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h4><p>æˆ‘é€šè¿‡docker æ¥éƒ¨ç½²ï¼Œè½»æ¾ç®€ä¾¿ä¸€ç‚¹</p><p>æ‹‰å–é•œåƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker pull rajnandan1/kener<br></code></pre></td></tr></table></figure><p>éƒ¨ç½²,æ³¨æ„å®¿ä¸»æœºéƒ¨ç½²çš„è·¯å¾„ä¸‹éœ€è¦æœ‰ä¸€ä¸ªconfigæ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker run -d -v /root/kener/config:/config -p 127.0.0.1:3000:3000 -e <span class="hljs-string">&quot;GH_TOKEN=1234&quot;</span> rajnandan1/kener<br></code></pre></td></tr></table></figure><hr><h4 id="nginxä¸è¯ä¹¦é…ç½®"><a href="#nginxä¸è¯ä¹¦é…ç½®" class="headerlink" title="nginxä¸è¯ä¹¦é…ç½®"></a>nginxä¸è¯ä¹¦é…ç½®</h4><p>é¦–å…ˆcloudflareä¸Šåˆ›å»ºä¸€ä¸ªåŸŸå</p><p>ä½¿ç”¨certbotç»™åŸŸååˆ›å»ºsslè¯ä¹¦</p><p><a href="https://blog.kxllx.shop/2024/07/24/2024.7.24-1/">ä½¿ç”¨snapå®‰è£…çš„certbotç®¡ç† SSL è¯ä¹¦ - Hexo (kxllx.shop)</a></p><p>æ³¨æ„ï¼Œcertbotä¼šè‡ªåŠ¨æ·»åŠ nginxä¸Škenerçš„é…ç½®ä¿¡æ¯ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰åšåå‘ä»£ç†ï¼Œä¸”é…ç½®çš„æœ‰ç‚¹é—®é¢˜ï¼Œè¿˜æ˜¯è¦è‡ªè¡Œé…ç½® &#x2F;etc&#x2F;nginx&#x2F;nginx.conf</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash">server &#123;<br>    server_name <span class="hljs-comment">#yourkener&#x27;s domain;</span><br><br>    <span class="hljs-comment"># SSL é…ç½®</span><br>    listen [::]:443 ssl ipv6only=on;<br>    listen 443 ssl;<br>    ssl_certificate /etc/letsencrypt/live/kener.kxllx.shop/fullchain.pem;<br>    ssl_certificate_key /etc/letsencrypt/live/kener.kxllx.shop/privkey.pem;<br>    include /etc/letsencrypt/options-ssl-nginx.conf;<br>    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;<br><br>    location / &#123;<br>        <span class="hljs-comment"># å°†æµé‡è½¬å‘åˆ°æœ¬åœ°è¿è¡Œçš„ Kener å®¹å™¨</span><br>        proxy_pass http://127.0.0.1:3000;<br>        proxy_set_header Host <span class="hljs-variable">$host</span>;<br>        proxy_set_header X-Real-IP <span class="hljs-variable">$remote_addr</span>;<br>        proxy_set_header X-Forwarded-For <span class="hljs-variable">$proxy_add_x_forwarded_for</span>;<br>        proxy_set_header X-Forwarded-Proto <span class="hljs-variable">$scheme</span>;<br>    &#125;<br><br>    <span class="hljs-comment"># å¤„ç† 404 é¡µé¢ï¼Œé˜²æ­¢éæ³•è·¯å¾„è¯·æ±‚</span><br>    error_page 404 /404.html;<br>    location = /404.html &#123;<br>        internal;<br>    &#125;<br>&#125;<br><br>server &#123;<br>    <span class="hljs-comment"># é‡å®šå‘ HTTP åˆ° HTTPS</span><br>    listen 80;<br>    listen [::]:80;<br>    server_name <span class="hljs-comment">#yourkener&#x27;s domain;</span><br>    <span class="hljs-built_in">return</span> 301 https://$host<span class="hljs-variable">$request_uri</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>æ·»åŠ å®Œé‡æ–°åŠ è½½nginx</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl reload nginx<br></code></pre></td></tr></table></figure><hr><h4 id="é…ç½®æ¢é’ˆä¸ç½‘ç«™è®¾ç½®"><a href="#é…ç½®æ¢é’ˆä¸ç½‘ç«™è®¾ç½®" class="headerlink" title="é…ç½®æ¢é’ˆä¸ç½‘ç«™è®¾ç½®"></a>é…ç½®æ¢é’ˆä¸ç½‘ç«™è®¾ç½®</h4><p>åœ¨kenerçš„é…ç½®æ–‡ä»¶å¤¹configä¸­ï¼Œä¿®æ”¹monitors.yamlä¸site.yamlè¿™ä¸¤ä¸ªæ–‡ä»¶</p><p>monitors.yamlæ·»åŠ ç›‘æ§ç½‘ç«™ä¾‹å­</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-bullet">-</span> <span class="hljs-string">name: kxllx&#x27;s blog</span><br>  <span class="hljs-attribute">description</span><span class="hljs-punctuation">:</span> <span class="hljs-string">blog</span><br>  <span class="hljs-attribute">tag</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;blog&quot;</span><br>  <span class="hljs-attribute">image</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/google.png&quot;</span><br>  <span class="hljs-attribute">api</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-attribute">method</span><span class="hljs-punctuation">:</span> <span class="hljs-string">GET</span><br>      <span class="hljs-attribute">url</span><span class="hljs-punctuation">:</span> <span class="hljs-string">https://blog.kxllx.shop</span><br></code></pre></td></tr></table></figure><hr><h3 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h3><p><a href="https://github.com/rajnandan1/kener">rajnandan1&#x2F;kenerï¼š Kener æ˜¯ä¸€ä¸ªç°ä»£è‡ªæ‰˜ç®¡çš„çŠ¶æ€é¡µé¢ï¼ŒåŒ…æ‹¬ç”µæ±  (github.com)</a></p>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å…³äºdockerä¸­å®¹å™¨èƒ½å¦ip+ç«¯å£ç›´æ¥è®¿é—®çš„é—®é¢˜</title>
    <link href="/2024/09/04/2024.9.4-1/"/>
    <url>/2024/09/04/2024.9.4-1/</url>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰å»ºç«™ä¸€ç›´æƒ³æœç»å¤–éƒ¨ä»¥ip+ç«¯å£çš„æ–¹å¼è®¿é—®ç½‘ç«™ï¼Œè¯•è¿‡cloudflareé…ç½®wafè§„åˆ™ï¼Œnginxé…ç½®åä»£è§„åˆ™ç­‰ï¼Œä¸€ç›´ä¸è¡Œï¼Œä»Šå¤©çœ‹åˆ°åº”è¯¥æ˜¯dockerå®¹å™¨ç«¯å£æ˜ å°„çš„åŸå› </p><hr><h4 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h4><h5 id="1-chev-app-1-å®¹å™¨"><a href="#1-chev-app-1-å®¹å™¨" class="headerlink" title="1.chev-app-1 å®¹å™¨"></a>1.<code>chev-app-1</code> å®¹å™¨</h5><ul><li><strong>é•œåƒ</strong>: <code>nmtan/chevereto:1.4.1</code></li><li><strong>ç«¯å£æ˜ å°„</strong>: <code>127.0.0.1:7777-&gt;80/tcp</code></li></ul><p>è¿™ä¸ªæ˜ å°„è¡¨ç¤º <code>chev-app-1</code> å®¹å™¨çš„å†…éƒ¨ç«¯å£ <code>80</code> æ˜ å°„åˆ°äº†ä¸»æœºçš„ <code>127.0.0.1:7777</code>ã€‚ç”±äºå®ƒä½¿ç”¨çš„æ˜¯ <code>127.0.0.1</code>ï¼ˆæœ¬åœ°ä¸»æœºï¼‰ï¼Œåªæœ‰ä¸»æœºè‡ªå·±å¯ä»¥é€šè¿‡ <code>localhost</code> æˆ–è€… <code>127.0.0.1</code> è®¿é—®è¿™ä¸ªæœåŠ¡ã€‚æ¢å¥è¯è¯´ï¼Œåªæœ‰åœ¨æœ¬æœºä¸Šè¿è¡Œçš„ç¨‹åºæˆ–è€…ç”¨æˆ·æ‰èƒ½è®¿é—® <code>http://127.0.0.1:7777</code>ã€‚å…¶ä»–å¤–éƒ¨ç½‘ç»œçš„ IP åœ°å€ï¼ˆåŒ…æ‹¬å±€åŸŸç½‘ä¸­çš„å…¶ä»–è®¾å¤‡ï¼‰æ— æ³•ç›´æ¥è®¿é—® <code>chev-app-1</code> æœåŠ¡ã€‚</p><h5 id="2-chev-db-1-å®¹å™¨"><a href="#2-chev-db-1-å®¹å™¨" class="headerlink" title="2. chev-db-1 å®¹å™¨"></a>2. <code>chev-db-1</code> å®¹å™¨</h5><ul><li><strong>é•œåƒ</strong>: <code>mariadb</code></li><li><strong>ç«¯å£æ˜ å°„</strong>: <code>3306/tcp</code></li></ul><p><code>chev-db-1</code> å®¹å™¨çš„ç«¯å£ <code>3306</code> å¹¶æ²¡æœ‰æ˜ å°„åˆ°ä¸»æœºçš„ä»»ä½•ç«¯å£ã€‚è¿™æ„å‘³ç€è¯¥å®¹å™¨çš„æœåŠ¡åªèƒ½åœ¨ Docker å†…éƒ¨ç½‘ç»œä¸­è¢«è®¿é—®ï¼Œæ— æ³•é€šè¿‡ä¸»æœºçš„ IP åœ°å€ç›´æ¥ä»å¤–éƒ¨ç½‘ç»œè®¿é—®ã€‚</p><h5 id="3-synctv-å®¹å™¨"><a href="#3-synctv-å®¹å™¨" class="headerlink" title="3. synctv å®¹å™¨"></a>3. <code>synctv</code> å®¹å™¨</h5><ul><li><strong>é•œåƒ</strong>: <code>synctvorg/synctv</code></li><li><strong>ç«¯å£æ˜ å°„</strong>: <code>0.0.0.0:8086-&gt;8080/tcp</code></li></ul><p><code>synctv</code> å®¹å™¨çš„å†…éƒ¨ç«¯å£ <code>8080</code> æ˜ å°„åˆ°äº†ä¸»æœºçš„ <code>8086</code> ç«¯å£ï¼Œå¹¶ä½¿ç”¨ <code>0.0.0.0</code> ä½œä¸º IP åœ°å€ã€‚è¿™æ„å‘³ç€ä¸»æœºä¸Šçš„æ‰€æœ‰ç½‘ç»œæ¥å£ï¼ˆåŒ…æ‹¬æœ¬åœ°ä¸»æœºã€å±€åŸŸç½‘ IP å’Œå¤–éƒ¨ IPï¼‰éƒ½å¯ä»¥è®¿é—®è¿™ä¸ªæœåŠ¡ã€‚ä»»ä½•è®¾å¤‡åªè¦çŸ¥é“ä¸»æœºçš„ IP åœ°å€å’Œç«¯å£ <code>8086</code>ï¼Œéƒ½å¯ä»¥è®¿é—®è¿™ä¸ªæœåŠ¡ï¼Œä¾‹å¦‚ <code>http://your-host-ip:8086</code>ã€‚</p><hr><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li><strong><code>127.0.0.1</code> (æœ¬åœ°ä¸»æœº) è®¿é—®</strong>ï¼šä»…é™æœ¬æœºè®¿é—®ï¼Œå¤–éƒ¨è®¾å¤‡æ— æ³•è®¿é—®ã€‚ä¾‹å¦‚ï¼Œ<code>chev-app-1</code> åªèƒ½é€šè¿‡æœ¬åœ°ä¸»æœºè®¿é—®ã€‚</li><li><strong><code>0.0.0.0</code> (æ‰€æœ‰ç½‘ç»œæ¥å£) è®¿é—®</strong>ï¼šå¯ä»¥è¢«å¤–éƒ¨ç½‘ç»œè®¿é—®ã€‚ä¾‹å¦‚ï¼Œ<code>synctv</code> å¯ä»¥é€šè¿‡ä¸»æœºçš„ IP åœ°å€å’Œç›¸åº”ç«¯å£ä»å¤–éƒ¨è®¿é—®ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cheveretoç«™çš„è¿ç§»</title>
    <link href="/2024/09/03/2024.9.3-1/"/>
    <url>/2024/09/03/2024.9.3-1/</url>
    
    <content type="html"><![CDATA[<p>ä¸€ç›´æƒ³æŠŠç¾å›½å°é¸¡ä¸Šçš„cheveretoç«™ç§»åˆ°å¤§é˜ªçš„å°é¸¡ä¸Šï¼Œé—®å°±æ˜¯ä¼ åˆ°ç¾å›½çš„é€Ÿåº¦æ…¢çš„ä»¤äººå‘æŒ‡</p><hr><h4 id="linuxæ–‡ä»¶å¤¹çš„æ‰“åŒ…"><a href="#linuxæ–‡ä»¶å¤¹çš„æ‰“åŒ…" class="headerlink" title="linuxæ–‡ä»¶å¤¹çš„æ‰“åŒ…"></a>linuxæ–‡ä»¶å¤¹çš„æ‰“åŒ…</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tar -cvf chevereto.tar chevereto/<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ-cè¡¨ç¤ºåˆ›å»ºæ–°çš„å½’æ¡£æ–‡ä»¶ï¼Œ-zè¡¨ç¤ºä½¿ç”¨gzipå‹ç¼©ï¼Œ-vè¡¨ç¤ºæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼Œ-fè¡¨ç¤ºæŒ‡å®šå½’æ¡£æ–‡ä»¶åã€‚testè¡¨ç¤ºè¦æ‰“åŒ…çš„ç›®å½•</p><p>æˆ‘åœ¨è¿™é‡Œæ‰“åŒ…äº†cheveretoæ•´ä¸ªé…ç½®æ–‡ä»¶å¤¹</p><hr><h4 id="æœåŠ¡å¯åŠ¨"><a href="#æœåŠ¡å¯åŠ¨" class="headerlink" title="æœåŠ¡å¯åŠ¨"></a>æœåŠ¡å¯åŠ¨</h4><p>å°†chevereto.tarè§£å‹åˆ°ç›®æ ‡æœº&#x2F;home&#x2F;webè·¯å¾„ä¸‹</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">tar</span> -xvf chevereto.tar<br></code></pre></td></tr></table></figure><p>å…ˆæ‹‰å–mariadbä¸chevereto:1.4.1çš„åŒ…ï¼ˆæ³¨æ„ï¼Œæ”¯æŒä¸­æ–‡çš„chevereto:1.4.1ä¸èƒ½åœ¨dockerè‡ªåŠ¨æ‹‰å–ï¼Œéœ€è¦æ‰‹åŠ¨ä¸‹è½½å¯¼å…¥ï¼Œæ„Ÿè°¢å¤§ä½¬çš„åŒ…ä¸‹è½½åœ°å€<a href="https://alist.xiayexiaolu.top/d/softwares/docker/chevereto/chevereto.tar%EF%BC%89">https://alist.xiayexiaolu.top/d/softwares/docker/chevereto/chevereto.tarï¼‰</a></p><p>åŸæœ¬æ˜¯ç”¨docker-composeéƒ¨ç½²çš„ï¼Œç°åœ¨ä¾æ—§å¯åŠ¨dokcer-composeè¿›è¡Œéƒ¨ç½²å°±å¯ä»¥äº†ï¼Œä¸ä¼šå½±å“dockerç°æœ‰æœåŠ¡</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">docker-compose up -d</span><br></code></pre></td></tr></table></figure><p>docker-compose.ymlé…ç½®å¦‚ä¸‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&#x27;3&#x27;</span><br><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">db:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">mariadb</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./db:/var/lib/mysql:rw</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">default</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-comment">#yourpasswd</span><br>      <span class="hljs-attr">MYSQL_DATABASE:</span> <span class="hljs-string">chevereto</span><br>      <span class="hljs-attr">MYSQL_USER:</span> <span class="hljs-comment">#youruser</span><br>      <span class="hljs-attr">MYSQL_PASSWORD:</span> <span class="hljs-comment">#yourpasswd</span><br><br>  <span class="hljs-attr">app:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">nmtan/chevereto:1.4.1</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;127.0.0.1:7777:80&quot;</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">default</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">CHEVERETO_DB_HOST:</span> <span class="hljs-string">db</span><br>      <span class="hljs-attr">CHEVERETO_DB_NAME:</span> <span class="hljs-string">chevereto</span><br>      <span class="hljs-attr">CHEVERETO_DB_USERNAME:</span> <span class="hljs-comment">#youruser # ä¸dbçš„è®¾ç½®ä¸€ä¸€å¯¹åº”</span><br>      <span class="hljs-attr">CHEVERETO_DB_PASSWORD:</span> <span class="hljs-comment">#yourpasswd # ä¸dbçš„è®¾ç½®ä¸€ä¸€å¯¹åº”</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./app/images:/var/www/html/images:rw</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./app/php.ini:/usr/local/etc/php/php.ini:ro</span><br>    <span class="hljs-attr">depends_on:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">db</span><br></code></pre></td></tr></table></figure><hr><h4 id="é…ç½®åä»£"><a href="#é…ç½®åä»£" class="headerlink" title="é…ç½®åä»£"></a>é…ç½®åä»£</h4><p>åœ¨nginx.configä¸­åŠ ä¸Šcheveretoçš„éƒ¨åˆ†</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>      <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span> default_server;<br>      <span class="hljs-attribute">listen</span> [::]:<span class="hljs-number">80</span> default_server;<br>      <span class="hljs-attribute">server_name</span> _;<br>      <span class="hljs-attribute">return</span> <span class="hljs-number">403</span>;<br>    &#125;<br><br><span class="hljs-section">server</span> &#123;<br><span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl;<br><span class="hljs-attribute">server_name</span> <span class="hljs-comment">#youdomain;</span><br><br>    ssl_certificate /etc/letsencrypt/live/<span class="hljs-comment">#youdomain /fullchain.pem; </span><br>    <span class="hljs-comment"># managed by Certbot</span><br>    ssl_certificate_key /etc/letsencrypt/live/<span class="hljs-comment">#youdomain /privkey.pem; </span><br>    <span class="hljs-comment"># managed by Certbot</span><br>    include /etc/letsencrypt/options-ssl-nginx.conf;<br>    <span class="hljs-attribute">ssl_dhparam</span> /etc/letsencrypt/ssl-dhparams.pem;<br><br><span class="hljs-attribute">ssl_ciphers</span> <span class="hljs-comment">###;</span><br><br>location / &#123;<br><span class="hljs-attribute">proxy_pass</span> http://127.0.0.1:7777/;<br><span class="hljs-attribute">proxy_set_header</span> Host <span class="hljs-variable">$host</span>;<br><span class="hljs-attribute">proxy_set_header</span> X-Real-IP <span class="hljs-variable">$remote_addr</span>;<br><span class="hljs-attribute">proxy_set_header</span> X-Forwarded-For <span class="hljs-variable">$proxy_add_x_forwarded_for</span>;<br><span class="hljs-attribute">proxy_set_header</span> X-Forwarded-Proto <span class="hljs-variable">$scheme</span>;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h4 id="é…ç½®è¯ä¹¦"><a href="#é…ç½®è¯ä¹¦" class="headerlink" title="é…ç½®è¯ä¹¦"></a>é…ç½®è¯ä¹¦</h4><p>ç›´æ¥æŠŠæºæœåŠ¡å™¨ä¸­çš„è¯ä¹¦æ–‡ä»¶æ‹·è´è¿‡æ¥å‡ºç°äº†é—®é¢˜ï¼Œè¿˜æ˜¯ç”¨certbotæ–¹ä¾¿è¯ä¹¦çš„ç»Ÿä¸€ç®¡ç†</p><p>æ–°å»ºå¥½è¯ä¹¦åè¯ä¹¦æ–‡ä»¶ç»Ÿä¸€åœ¨&#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;è·¯å¾„ä¸‹ï¼Œå¹¶åœ¨nginx.configä¸­é…ç½®</p><p>ä½¿ç”¨certbotå‘½ä»¤æŸ¥çœ‹è¯ä¹¦çŠ¶æ€ï¼ŒæŸ¥çœ‹æ˜¯å¦å¯ä»¥æ­£å¸¸è‡ªåŠ¨ç»­æœŸ</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ada">certbot certificates<br>sudo certbot renew <span class="hljs-comment">--dry-run</span><br></code></pre></td></tr></table></figure><p>è®¿é—®åŸŸåå¯æ­£å¸¸è®¿é—®</p><hr><h4 id="ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶å¤§å°"><a href="#ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶å¤§å°" class="headerlink" title="ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶å¤§å°"></a>ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶å¤§å°</h4><p>ä¿®æ”¹php.iniæ–‡ä»¶</p><hr><h3 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h3><p><a href="https://blog.csdn.net/Alaiks/article/details/138001751">æ­å»ºä¸ªäººå›¾åºŠ_chevereto-CSDNåšå®¢</a></p><p><a href="https://www.ioiox.com/archives/80.html">docker compose éƒ¨ç½²è¿ç§» Chevereto å›¾åºŠç¨‹åºæ•™ç¨‹ - æ€æœ‰äº‘ - IOIOX</a></p><p><a href="https://blog.csdn.net/qq_19564393/article/details/108506062">ä¿®æ”¹Cheveretoçš„APIä¸Šä¼ ç›¸å†Œå’Œç”¨æˆ·_chevereto api-CSDNåšå®¢</a></p><p><a href="https://segmentfault.com/q/1010000038224029">php - Chevereto çš„ PHP 7.2 é…ç½®ä¿®æ”¹æœ€å¤§ä¸Šä¼ å®¹é‡åä¸ºä½•ä»æ— æ³•ä¸Šä¼ å¤§äº 10MB çš„å›¾ç‰‡ï¼Ÿ - SegmentFault æ€å¦</a></p>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä½¿ç”¨iptablesé…ç½®é˜²ç«å¢™</title>
    <link href="/2024/07/26/2024.7.26-1/"/>
    <url>/2024/07/26/2024.7.26-1/</url>
    
    <content type="html"><![CDATA[<h4 id="iptables"><a href="#iptables" class="headerlink" title="iptables"></a>iptables</h4><p><strong>åŠŸèƒ½</strong>: <code>iptables</code> æ˜¯ä¸€ä¸ªå¼ºå¤§è€Œå¤æ‚çš„å·¥å…·ï¼Œç”¨äºé…ç½®å’Œç®¡ç† Linux å†…æ ¸çš„ç½‘ç»œåŒ…è¿‡æ»¤ç³»ç»Ÿã€‚å®ƒå…è®¸ç”¨æˆ·è®¾ç½®è¯¦ç»†çš„ç½‘ç»œè¿‡æ»¤è§„åˆ™ï¼Œæ§åˆ¶ç½‘ç»œæµé‡çš„è¡Œä¸ºã€‚</p><p><strong>é…ç½®</strong>: é€šè¿‡ç›´æ¥ç¼–è¾‘è§„åˆ™é“¾æ¥é…ç½®ã€‚è§„åˆ™é“¾åŒ…æ‹¬ <code>INPUT</code>, <code>FORWARD</code>, <code>OUTPUT</code> ç­‰ï¼Œç”¨æˆ·å¯ä»¥æ·»åŠ ã€åˆ é™¤å’Œä¿®æ”¹è§„åˆ™ã€‚é…ç½®æ–‡ä»¶ä¸æ˜“è¯»å†™ï¼Œé€šå¸¸éœ€è¦ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·è¿›è¡Œæ“ä½œã€‚</p><p><strong>çµæ´»æ€§</strong>: æä¾›äº†é«˜åº¦çš„çµæ´»æ€§å’Œæ§åˆ¶ï¼Œå¯ä»¥å®ç°éå¸¸ç»†è‡´çš„ç½‘ç»œæµé‡ç®¡ç†ï¼ŒåŒ…æ‹¬å¯¹ç‰¹å®šæºã€ç›®çš„ã€åè®®ã€ç«¯å£ç­‰çš„æ§åˆ¶ã€‚</p><p><strong>ä½¿ç”¨åœºæ™¯</strong>: é€šå¸¸ç”¨äºé«˜çº§ç”¨æˆ·æˆ–ç®¡ç†å‘˜ï¼Œä»–ä»¬éœ€è¦æ§åˆ¶å¤æ‚çš„ç½‘ç»œé…ç½®æˆ–è°ƒè¯•é˜²ç«å¢™è®¾ç½®ã€‚</p><p><strong>å‘½ä»¤ç¤ºä¾‹</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">iptables -A INPUT -p tcp --dport 80 -j ACCEPT<br>iptables -A INPUT -p tcp --dport 22 -j DROP<br></code></pre></td></tr></table></figure><hr><h4 id="ufw-Uncomplicated-Firewall"><a href="#ufw-Uncomplicated-Firewall" class="headerlink" title="ufw(Uncomplicated Firewall)"></a>ufw(Uncomplicated Firewall)</h4><p><strong>åŠŸèƒ½</strong>: <code>ufw</code> æ˜¯ <code>iptables</code> çš„ä¸€ä¸ªå‰ç«¯å·¥å…·ï¼Œæ—¨åœ¨ç®€åŒ–é˜²ç«å¢™é…ç½®ã€‚å®ƒä¸ºç”¨æˆ·æä¾›äº†ä¸€ä¸ªæ›´ç®€å•çš„å‘½ä»¤è¡Œæ¥å£æ¥ç®¡ç†é˜²ç«å¢™è§„åˆ™ï¼Œé€‚åˆé‚£äº›éœ€è¦åŸºæœ¬é˜²ç«å¢™åŠŸèƒ½è€Œä¸å¸Œæœ›æ·±å…¥åˆ° <code>iptables</code> å¤æ‚é…ç½®ä¸­çš„ç”¨æˆ·ã€‚</p><p><strong>é…ç½®</strong>: é€šè¿‡ç®€å•çš„å‘½ä»¤è¡Œå·¥å…·æ¥é…ç½®ï¼Œæä¾›äº†æ˜“äºç†è§£çš„è¯­æ³•ã€‚é€‚åˆåˆå­¦è€…å’Œæ™®é€šç”¨æˆ·ã€‚</p><p><strong>çµæ´»æ€§</strong>: ç›¸æ¯” <code>iptables</code>ï¼Œ<code>ufw</code> æä¾›çš„åŠŸèƒ½è¾ƒä¸ºåŸºç¡€ï¼Œä½†å¯¹äºå¸¸è§çš„é˜²ç«å¢™éœ€æ±‚å·²ç»è¶³å¤Ÿã€‚å®ƒåŸºäº <code>iptables</code> å·¥ä½œï¼Œä½†éšè—äº†å¤§éƒ¨åˆ†å¤æ‚æ€§ã€‚</p><p><strong>ä½¿ç”¨åœºæ™¯</strong>: é€‚åˆæ™®é€šç”¨æˆ·æˆ–ç³»ç»Ÿç®¡ç†å‘˜ï¼Œä»–ä»¬éœ€è¦å¿«é€Ÿã€ç®€å•åœ°é…ç½®é˜²ç«å¢™è§„åˆ™ã€‚</p><p><strong>å‘½ä»¤ç¤ºä¾‹</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ufw allow 80/tcp<br>ufw deny 22/tcp<br></code></pre></td></tr></table></figure><hr><h4 id="iptablesæŸ¥çœ‹å½“å‰è§„åˆ™"><a href="#iptablesæŸ¥çœ‹å½“å‰è§„åˆ™" class="headerlink" title="iptablesæŸ¥çœ‹å½“å‰è§„åˆ™"></a>iptablesæŸ¥çœ‹å½“å‰è§„åˆ™</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> iptables -L -v -n<br></code></pre></td></tr></table></figure><hr><h4 id="æ·»åŠ è®¿é—®è§„åˆ™"><a href="#æ·»åŠ è®¿é—®è§„åˆ™" class="headerlink" title="æ·»åŠ è®¿é—®è§„åˆ™"></a>æ·»åŠ è®¿é—®è§„åˆ™</h4><p><strong>å…è®¸sshè®¿é—®</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> iptables -A INPUT -p tcp --dport 22 -j ACCEPT<br></code></pre></td></tr></table></figure><p><code>-A INPUT</code>ï¼šåœ¨ INPUT é“¾ä¸Šæ·»åŠ è§„åˆ™ã€‚</p><p><code>-p tcp</code>ï¼šåè®®ä¸º TCPã€‚</p><p><code>--dport 22</code>ï¼šç›®æ ‡ç«¯å£ä¸º 22ï¼ˆSSHï¼‰ã€‚</p><p><code>-j ACCEPT</code>ï¼šæ¥å—åŒ¹é…çš„æ•°æ®åŒ…ã€‚</p><p><strong>æ‹’ç»æŸä¸ªipçš„è®¿é—®</strong></p><p><code>-s 192.168.1.100</code>ï¼šæ¥æº IP åœ°å€ä¸º 192.168.1.100ã€‚</p><p><code>-j DROP</code>ï¼šä¸¢å¼ƒåŒ¹é…çš„æ•°æ®åŒ…ã€‚</p><hr><h4 id="åˆ é™¤è§„åˆ™"><a href="#åˆ é™¤è§„åˆ™" class="headerlink" title="åˆ é™¤è§„åˆ™"></a>åˆ é™¤è§„åˆ™</h4><p>è¦åˆ é™¤è§„åˆ™ï¼Œå¯ä»¥ä½¿ç”¨è§„åˆ™çš„ç¼–å·ã€‚é¦–å…ˆåˆ—å‡ºè§„åˆ™åŠå…¶ç¼–å·ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> iptables -L --line-numbers<br></code></pre></td></tr></table></figure><p>ç„¶ååˆ é™¤è§„åˆ™ï¼Œä¾‹å¦‚åˆ é™¤ INPUT é“¾ä¸Šçš„ç¬¬ 2 æ¡è§„åˆ™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> iptables -D INPUT 2<br></code></pre></td></tr></table></figure><hr><h4 id="å¸¸è§æ“ä½œ"><a href="#å¸¸è§æ“ä½œ" class="headerlink" title="å¸¸è§æ“ä½œ"></a>å¸¸è§æ“ä½œ</h4><h4 id="æ¸…ç©ºæ‰€æœ‰è§„åˆ™"><a href="#æ¸…ç©ºæ‰€æœ‰è§„åˆ™" class="headerlink" title="æ¸…ç©ºæ‰€æœ‰è§„åˆ™"></a>æ¸…ç©ºæ‰€æœ‰è§„åˆ™</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> iptables -F<br></code></pre></td></tr></table></figure><h4 id="è®¾ç½®é»˜è®¤ç­–ç•¥"><a href="#è®¾ç½®é»˜è®¤ç­–ç•¥" class="headerlink" title="è®¾ç½®é»˜è®¤ç­–ç•¥"></a>è®¾ç½®é»˜è®¤ç­–ç•¥</h4><p>è®¾ç½®é»˜è®¤ç­–ç•¥ä¸ºæ‹’ç»æ‰€æœ‰æµé‡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> iptables -P INPUT DROP<br><span class="hljs-built_in">sudo</span> iptables -P FORWARD DROP<br><span class="hljs-built_in">sudo</span> iptables -P OUTPUT ACCEPT<br></code></pre></td></tr></table></figure><h4 id="å…è®¸æ‰€æœ‰æ¥è‡ªæœ¬æœºçš„æµé‡"><a href="#å…è®¸æ‰€æœ‰æ¥è‡ªæœ¬æœºçš„æµé‡" class="headerlink" title="å…è®¸æ‰€æœ‰æ¥è‡ªæœ¬æœºçš„æµé‡"></a>å…è®¸æ‰€æœ‰æ¥è‡ªæœ¬æœºçš„æµé‡</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> iptables -A INPUT -i lo -j ACCEPT<br></code></pre></td></tr></table></figure><ul><li><code>-i lo</code>ï¼šæŒ‡å®šæ¥å£ä¸º loopbackã€‚</li></ul><hr><h4 id="æ£€æŸ¥ç«¯å£å¼€æ”¾æƒ…å†µ"><a href="#æ£€æŸ¥ç«¯å£å¼€æ”¾æƒ…å†µ" class="headerlink" title="æ£€æŸ¥ç«¯å£å¼€æ”¾æƒ…å†µ"></a>æ£€æŸ¥ç«¯å£å¼€æ”¾æƒ…å†µ</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">nmap</span> -sS -sU -p- <span class="hljs-number">127.0.0.1</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä½¿ç”¨snapå®‰è£…çš„certbotç®¡ç† SSL è¯ä¹¦</title>
    <link href="/2024/07/24/2024.7.24-1/"/>
    <url>/2024/07/24/2024.7.24-1/</url>
    
    <content type="html"><![CDATA[<h4 id="å®‰è£…cerbotå’ŒCertbot-Nginx-æ’ä»¶"><a href="#å®‰è£…cerbotå’ŒCertbot-Nginx-æ’ä»¶" class="headerlink" title="å®‰è£…cerbotå’ŒCertbot Nginx æ’ä»¶"></a>å®‰è£…cerbotå’ŒCertbot Nginx æ’ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt update<br><span class="hljs-built_in">sudo</span> apt install certbot<br></code></pre></td></tr></table></figure><p>å®‰è£…nginxæ’ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt install python3-certbot-nginx<br></code></pre></td></tr></table></figure><h4 id="ç”Ÿæˆè¯ä¹¦"><a href="#ç”Ÿæˆè¯ä¹¦" class="headerlink" title="ç”Ÿæˆè¯ä¹¦"></a>ç”Ÿæˆè¯ä¹¦</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> certbot --nginx -d <span class="hljs-comment">#yourdomain</span><br></code></pre></td></tr></table></figure><h4 id="æ›´æ–°Nginxé…ç½®"><a href="#æ›´æ–°Nginxé…ç½®" class="headerlink" title="æ›´æ–°Nginxé…ç½®"></a>æ›´æ–°Nginxé…ç½®</h4><p>æ·»åŠ ssléƒ¨åˆ†</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">ssl_certificate <span class="hljs-regexp">/etc/</span>letsencrypt<span class="hljs-regexp">/live/</span><span class="hljs-comment">#yourdomain/fullchain.pem;</span><br>ssl_certificate_key<span class="hljs-regexp">/etc/</span>letsencrypt<span class="hljs-regexp">/live/</span><span class="hljs-comment">#yourdomain/privkey.pem;</span><br>include <span class="hljs-regexp">/etc/</span>letsencrypt/options-ssl-nginx.conf;<br>ssl_dhparam <span class="hljs-regexp">/etc/</span>letsencrypt/ssl-dhparams.pem;<br></code></pre></td></tr></table></figure><p>åœ¨å®Œæˆé…ç½®åï¼Œæµ‹è¯• Nginx é…ç½®æ˜¯å¦æ­£ç¡®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> nginx -t<br></code></pre></td></tr></table></figure><p>å¦‚æœé…ç½®æ²¡æœ‰é—®é¢˜ï¼Œé‡æ–°åŠ è½½ Nginxï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl reload nginx<br></code></pre></td></tr></table></figure><h4 id="è‡ªåŠ¨ç»­æœŸ"><a href="#è‡ªåŠ¨ç»­æœŸ" class="headerlink" title="è‡ªåŠ¨ç»­æœŸ"></a>è‡ªåŠ¨ç»­æœŸ</h4><p><code>certbot</code> ä¼šè‡ªåŠ¨é…ç½®ä¸€ä¸ªç³»ç»Ÿå®šæ—¶ä»»åŠ¡æ¥å¤„ç†è¯ä¹¦ç»­æœŸã€‚ä½ å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ‰‹åŠ¨æµ‹è¯•è‡ªåŠ¨ç»­æœŸåŠŸèƒ½ï¼š</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">sudo certbot renew <span class="hljs-comment">--dry-run</span><br></code></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹è¯ä¹¦çŠ¶æ€"><a href="#æŸ¥çœ‹è¯ä¹¦çŠ¶æ€" class="headerlink" title="æŸ¥çœ‹è¯ä¹¦çŠ¶æ€"></a>æŸ¥çœ‹è¯ä¹¦çŠ¶æ€</h4><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">certbot certificates</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆ›å»ºSyncTVç«™</title>
    <link href="/2024/07/24/2024.7.24-2/"/>
    <url>/2024/07/24/2024.7.24-2/</url>
    
    <content type="html"><![CDATA[<p>SyncTV æ˜¯ä¸€ä¸ªå…è®¸æ‚¨è¿œç¨‹ä¸€èµ·è§‚çœ‹ç”µå½±å’Œç›´æ’­çš„ç¨‹åºã€‚å®ƒæä¾›äº†åŒæ­¥è§‚çœ‹ã€å‰§é™¢å’Œä»£ç†åŠŸèƒ½ã€‚å¯¹è¿™ä¸ªç«™æ¯”è¾ƒæ„Ÿå…´è¶£ï¼Œæ­ä¸€ä¸‹ç©ç©</p><h4 id="SyncTV-github"><a href="#SyncTV-github" class="headerlink" title="SyncTV github"></a>SyncTV github</h4><p><a href="https://github.com/synctv-org/synctv/blob/main/README-CN.md">synctv&#x2F;README-CN.md at main Â· synctv-org&#x2F;synctv (github.com)</a></p>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ubuntuæŸ¥çœ‹è¿›ç¨‹</title>
    <link href="/2024/07/15/2024.7.15-1/"/>
    <url>/2024/07/15/2024.7.15-1/</url>
    
    <content type="html"><![CDATA[<p>ä¸€ç›´è®°ä¸ä½åœ¨linuxä¸­æ€ä¹ˆæŸ¥çœ‹è¿›ç¨‹ï¼Œè®°å½•ä¸€ä¸‹</p><h3 id="ä½¿ç”¨-pså‘½ä»¤"><a href="#ä½¿ç”¨-pså‘½ä»¤" class="headerlink" title="ä½¿ç”¨ pså‘½ä»¤"></a>ä½¿ç”¨ <code>ps</code>å‘½ä»¤</h3><p><code>ps</code> å‘½ä»¤å¯ä»¥åˆ—å‡ºå½“å‰ç³»ç»Ÿä¸Šæ‰€æœ‰è¿è¡Œçš„è¿›ç¨‹ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos">ps <span class="hljs-built_in">aux</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå‘½ä»¤ä¼šæ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·çš„æ‰€æœ‰è¿›ç¨‹ï¼Œåˆ—å‡ºè¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·ã€PIDã€CPUå’Œå†…å­˜ä½¿ç”¨æƒ…å†µç­‰ã€‚</p><h3 id="ä½¿ç”¨-top-å‘½ä»¤"><a href="#ä½¿ç”¨-top-å‘½ä»¤" class="headerlink" title="ä½¿ç”¨ top å‘½ä»¤"></a>ä½¿ç”¨ <code>top</code> å‘½ä»¤</h3><p><code>top</code> å‘½ä»¤å¯ä»¥å®æ—¶ç›‘æ§ç³»ç»Ÿä¸Šçš„è¿›ç¨‹æƒ…å†µï¼Œå¹¶æ˜¾ç¤ºç³»ç»Ÿèµ„æºçš„ä½¿ç”¨æƒ…å†µã€‚å¯åŠ¨ <code>top</code> å‘½ä»¤ï¼š</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coq"><span class="hljs-built_in">top</span><br></code></pre></td></tr></table></figure><p>ä½ å¯ä»¥çœ‹åˆ°ä¸€ä¸ªåŠ¨æ€æ›´æ–°çš„è¿›ç¨‹åˆ—è¡¨ï¼ŒæŒ‰ <code>q</code> é”®å¯ä»¥é€€å‡ºã€‚</p><h3 id="ä½¿ç”¨-htop-å‘½ä»¤"><a href="#ä½¿ç”¨-htop-å‘½ä»¤" class="headerlink" title="ä½¿ç”¨ htop å‘½ä»¤"></a>ä½¿ç”¨ <code>htop</code> å‘½ä»¤</h3><p><code>htop</code> æ˜¯ <code>top</code> å‘½ä»¤çš„ä¸€ä¸ªæ”¹è¿›ç‰ˆæœ¬ï¼Œæä¾›äº†æ›´å‹å¥½çš„ç”¨æˆ·ç•Œé¢ã€‚å®‰è£…å¹¶è¿è¡Œ <code>htop</code>ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">apt-<span class="hljs-built_in">get</span> install htop<br>htop<br></code></pre></td></tr></table></figure><p>å’Œ <code>top</code> ç±»ä¼¼ï¼Œ<code>htop</code> æ˜¾ç¤ºç³»ç»Ÿä¸Šçš„è¿›ç¨‹ï¼Œå¹¶å…è®¸ä½ é€šè¿‡é”®ç›˜å¿«æ·é”®è¿›è¡Œæ“ä½œã€‚</p><h3 id="ä½¿ç”¨-systemctl-å‘½ä»¤"><a href="#ä½¿ç”¨-systemctl-å‘½ä»¤" class="headerlink" title="ä½¿ç”¨ systemctl å‘½ä»¤"></a>ä½¿ç”¨ <code>systemctl</code> å‘½ä»¤</h3><p><code>systemctl</code> å‘½ä»¤å¯ä»¥åˆ—å‡ºç³»ç»Ÿä¸­æ‰€æœ‰çš„æœåŠ¡åŠå…¶çŠ¶æ€ï¼š</p><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dsconfig"><span class="hljs-string">systemctl</span> <span class="hljs-built_in">list-units</span> <span class="hljs-built_in">--type=service</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå‘½ä»¤ä¼šæ˜¾ç¤ºæ‰€æœ‰ç³»ç»ŸæœåŠ¡ï¼ŒåŒ…æ‹¬æ­£åœ¨è¿è¡Œå’Œæœªè¿è¡Œçš„æœåŠ¡ã€‚</p><p>æ€»ç»“ï¼šç”¨htopè¿˜æ˜¯æ–¹ä¾¿ç‚¹</p>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vocechatæ­å»º</title>
    <link href="/2024/07/04/2024.7.4-1/"/>
    <url>/2024/07/04/2024.7.4-1/</url>
    
    <content type="html"><![CDATA[<p>ä»ç—…å‹é‚£è¾¹äº†è§£åˆ°vocechatæ˜¯ä¸€æ¬¾æç®€ã€æè½»ã€æ— ç—•ã€åŒ¿åçš„èŠå¤©å·¥å…·ï¼Œå°è¯•æ­å»º</p><p>å®˜ç½‘ï¼š<a href="https://doc.voce.chat/zh-cn/install/install-by-docker#docker--nginx">Docker å®‰è£… | VoceChat</a></p><h4 id="ä½¿ç”¨docker-nginxæ–¹å¼éƒ¨ç½²ï¼š"><a href="#ä½¿ç”¨docker-nginxæ–¹å¼éƒ¨ç½²ï¼š" class="headerlink" title="ä½¿ç”¨docker+nginxæ–¹å¼éƒ¨ç½²ï¼š"></a>ä½¿ç”¨docker+nginxæ–¹å¼éƒ¨ç½²ï¼š</h4><h5 id="1-dockeréƒ¨ç½²vocechat"><a href="#1-dockeréƒ¨ç½²vocechat" class="headerlink" title="1.dockeréƒ¨ç½²vocechat"></a>1.dockeréƒ¨ç½²vocechat</h5><p>æ‹‰å–é•œåƒ</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta">docker pull privoce/vocechat-<span class="hljs-keyword">server</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œvocechat</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ruby">docker run -d --restart=always \<br>  -p <span class="hljs-number">3009</span><span class="hljs-symbol">:</span><span class="hljs-number">3000</span> \<br>  --name vocechat-server \<br>  -v ~<span class="hljs-regexp">/.vocechat-server/data</span><span class="hljs-symbol">:/home/vocechat-server/data</span> \<br>  privoce/vocechat-<span class="hljs-symbol">server:</span>latest \<br>  --network.frontend_url <span class="hljs-string">&quot;https://vocechat.yourdomain.com&quot;</span><br></code></pre></td></tr></table></figure><h5 id="2-é…ç½®ssl"><a href="#2-é…ç½®ssl" class="headerlink" title="2.é…ç½®ssl"></a>2.é…ç½®ssl</h5><p>åœ¨cloudflareä¸Šæ–°å»ºä¸€ä¸ªåŸŸå</p><p>å®‰è£…snapåŒ…ç®¡ç†å·¥å…·ï¼š</p><p>Snap æ˜¯ä¸€ä¸ªè½¯ä»¶æ‰“åŒ…å’Œéƒ¨ç½²ç³»ç»Ÿï¼Œå®ƒå…è®¸å¼€å‘è€…å°†åº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–é¡¹æ‰“åŒ…ä¸ºä¸€ä¸ªå•ç‹¬çš„å®‰å…¨æ²™ç›’åŒ–çš„è½¯ä»¶åŒ…ã€‚è¿™äº›è½¯ä»¶åŒ…å¯ä»¥åœ¨å„ç§ Linux å‘è¡Œç‰ˆä¸Šè¿è¡Œï¼Œè€Œä¸å—ç‰¹å®šå‘è¡Œç‰ˆçš„è½¯ä»¶åŒ…ç®¡ç†ç³»ç»Ÿçš„é™åˆ¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt update<br><span class="hljs-built_in">sudo</span> apt install snapd<br></code></pre></td></tr></table></figure><p>æµ‹è¯•å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">sudo</span> snap install hello-world</span><br>hello-world 6.4 from Canonicalâœ“ installed<br><span class="hljs-meta prompt_">$ </span><span class="language-bash">hello-world</span><br>Hello World!<br></code></pre></td></tr></table></figure><p>å®‰è£…Certbotï¼š</p><p>Certbotç”¨äºè‡ªåŠ¨åŒ–ç®¡ç† HTTPS è¯ä¹¦çš„è·å–ã€å®‰è£…ã€æ›´æ–°å’Œæ’¤é”€è¿‡ç¨‹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> snap install --classic certbot<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">ln</span> -s /snap/bin/certbot /usr/bin/certbot<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ Certbot å’Œ Nginx æ’ä»¶æ¥è·å– SSL è¯ä¹¦ï¼Œæ‰§è¡Œåä¼šè¦æ±‚è¾“å…¥é‚®ç®±ï¼Œé€‰æ‹©å¯æ³¨å†Œè¯ä¹¦çš„åŸŸå</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">sudo certbot <span class="hljs-comment">--nginx</span><br></code></pre></td></tr></table></figure><p>é…ç½®nginx</p><p>&#x2F;etc&#x2F;nginx&#x2F;nginx.conf</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">user</span> nginx;<br><span class="hljs-attribute">worker_processes</span> auto;<br><br><span class="hljs-attribute">error_log</span> /var/log/nginx/<span class="hljs-literal">error</span>.log <span class="hljs-literal">notice</span>;<br><span class="hljs-attribute">pid</span> /var/run/nginx.pid;<br><br><span class="hljs-section">events</span> &#123;<br>    <span class="hljs-attribute">worker_connections</span> <span class="hljs-number">1024</span>;<br>&#125;<br><br><span class="hljs-section">http</span> &#123;<br>    <span class="hljs-attribute">include</span> /etc/nginx/mime.types;<br>    <span class="hljs-attribute">default_type</span> application/octet-stream;<br><br>    <span class="hljs-attribute">log_format</span> main <span class="hljs-string">&#x27;<span class="hljs-variable">$remote_addr</span> - <span class="hljs-variable">$remote_user</span> [<span class="hljs-variable">$time_local</span>] &quot;<span class="hljs-variable">$request</span>&quot; &#x27;</span><br>                      <span class="hljs-string">&#x27;<span class="hljs-variable">$status</span> <span class="hljs-variable">$body_bytes_sent</span> &quot;<span class="hljs-variable">$http_referer</span>&quot; &#x27;</span><br>                      <span class="hljs-string">&#x27;&quot;<span class="hljs-variable">$http_user_agent</span>&quot; &quot;<span class="hljs-variable">$http_x_forwarded_for</span>&quot;&#x27;</span>;<br><br>    <span class="hljs-attribute">access_log</span> /var/log/nginx/access.log main;<br><br>    <span class="hljs-attribute">sendfile</span> <span class="hljs-literal">on</span>;<br>    <span class="hljs-attribute">keepalive_timeout</span> <span class="hljs-number">65</span>;<br><br>    <span class="hljs-attribute">include</span> /etc/nginx/conf.d/<span class="hljs-regexp">*.conf</span>;<br><br>    <span class="hljs-section">server</span> &#123;<br>        <span class="hljs-attribute">server_name</span> vocechat.yourdomain.shop;<br><br>        <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl;<br>        <span class="hljs-attribute">ssl_certificate</span> /etc/letsencrypt/live/vocechat.yourdomain.shop/fullchain.pem;<br>        <span class="hljs-attribute">ssl_certificate_key</span> /etc/letsencrypt/live/vocechat.yourdomain.shop/privkey.pem;<br>        <span class="hljs-attribute">include</span> /etc/letsencrypt/options-ssl-nginx.conf;<br>        <span class="hljs-attribute">ssl_dhparam</span> /etc/letsencrypt/ssl-dhparams.pem;<br><br>        <span class="hljs-section">location</span> / &#123;<br>            <span class="hljs-attribute">proxy_pass</span> http://127.0.0.1:3009;<br>            <span class="hljs-attribute">proxy_redirect</span> <span class="hljs-literal">off</span>;<br>            <span class="hljs-attribute">proxy_set_header</span> Host <span class="hljs-variable">$host</span>;<br>            <span class="hljs-attribute">proxy_set_header</span> X-Real-IP <span class="hljs-variable">$remote_addr</span>;<br>            <span class="hljs-attribute">proxy_set_header</span> X-Forwarded-For <span class="hljs-variable">$proxy_add_x_forwarded_for</span>;<br>            <span class="hljs-attribute">proxy_next_upstream</span> <span class="hljs-literal">error</span> timeout invalid_header http_500 http_502 http_503 http_504;<br>            <span class="hljs-attribute">proxy_max_temp_file_size</span> <span class="hljs-number">0</span>;<br>            <span class="hljs-attribute">proxy_http_version</span> <span class="hljs-number">1</span>.<span class="hljs-number">1</span>;<br>            <span class="hljs-attribute">proxy_set_header</span> Connection <span class="hljs-string">&#x27;&#x27;</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-section">server</span> &#123;<br>        <span class="hljs-attribute">if</span> (<span class="hljs-variable">$host</span> = vocechat.yourdomain.shop) &#123;<br>            <span class="hljs-attribute">return</span> <span class="hljs-number">301</span> https://<span class="hljs-variable">$host</span><span class="hljs-variable">$request_uri</span>;<br>        &#125; <span class="hljs-comment"># managed by Certbot</span><br>        <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;<br>        <span class="hljs-attribute">server_name</span> vocechat.yourdomain.shop;<br>        <span class="hljs-attribute">return</span> <span class="hljs-number">404</span>; <span class="hljs-comment"># managed by Certbot</span><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>é‡å¯ngnix</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> nginx -t<br><span class="hljs-built_in">sudo</span> systemctl reload nginx<br></code></pre></td></tr></table></figure><p>å°±å¯ä»¥è®¿é—®äº†</p>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>gitçš„åŸºç¡€ä½¿ç”¨</title>
    <link href="/2024/07/02/2024.7.2-1/"/>
    <url>/2024/07/02/2024.7.2-1/</url>
    
    <content type="html"><![CDATA[<h4 id="1-é…ç½®Git"><a href="#1-é…ç½®Git" class="headerlink" title="1.é…ç½®Git"></a>1.é…ç½®Git</h4><p>è®¾ç½®ç”¨æˆ·åå’Œé‚®ç®±</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">git config <span class="hljs-attr">--global</span> user<span class="hljs-selector-class">.name</span> <span class="hljs-string">&quot;Your Name&quot;</span><br>git config <span class="hljs-attr">--global</span> user<span class="hljs-selector-class">.email</span> <span class="hljs-string">&quot;youremail@example.com&quot;</span><br></code></pre></td></tr></table></figure><h4 id="2-åˆ›å»ºå’Œå…‹éš†ä»“åº“"><a href="#2-åˆ›å»ºå’Œå…‹éš†ä»“åº“" class="headerlink" title="2.åˆ›å»ºå’Œå…‹éš†ä»“åº“"></a>2.åˆ›å»ºå’Œå…‹éš†ä»“åº“</h4><p>åˆ›å»ºä¸€ä¸ªæ–°çš„æœ¬åœ° Git ä»“åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> myproject<br><span class="hljs-built_in">cd</span> myproject<br>git init<br></code></pre></td></tr></table></figure><p>ä»è¿œç¨‹ä»“åº“å…‹éš†ä¸€ä¸ªæœ¬åœ°å‰¯æœ¬ã€‚</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">git <span class="hljs-keyword">clone</span> <span class="hljs-title">https</span>://github.com/user/repo.git<br></code></pre></td></tr></table></figure><h4 id="3-åŸºæœ¬æ“ä½œ"><a href="#3-åŸºæœ¬æ“ä½œ" class="headerlink" title="3.åŸºæœ¬æ“ä½œ"></a>3.åŸºæœ¬æ“ä½œ</h4><p>æŸ¥çœ‹ä»“åº“çŠ¶æ€</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">git status</span><br></code></pre></td></tr></table></figure><p>å°†æ›´æ”¹çš„æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">git <span class="hljs-built_in">add</span> filename<br></code></pre></td></tr></table></figure><p>æ·»åŠ æ‰€æœ‰æ›´æ”¹çš„æ–‡ä»¶</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">git <span class="hljs-built_in">add</span> .<br></code></pre></td></tr></table></figure><p>å°†æš‚å­˜åŒºçš„æ–‡ä»¶æäº¤åˆ°æœ¬åœ°ä»“åº“</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">git</span> commit -m <span class="hljs-string">&quot;Your commit message&quot;</span><br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æäº¤çš„å†å²</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">git <span class="hljs-built_in">log</span> <span class="hljs-comment">--oneline</span><br></code></pre></td></tr></table></figure><h4 id="4-åˆ†æ”¯æ“ä½œ"><a href="#4-åˆ†æ”¯æ“ä½œ" class="headerlink" title="4.åˆ†æ”¯æ“ä½œ"></a>4.åˆ†æ”¯æ“ä½œ</h4><p>åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">git branch branch_name</span><br></code></pre></td></tr></table></figure><p>åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">git checkout branch_name</span><br></code></pre></td></tr></table></figure><p>åŒæ—¶åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æ–°åˆ†æ”¯</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">git</span> checkout -<span class="hljs-keyword">b</span> new_branch_name<br></code></pre></td></tr></table></figure><p>å°†æŒ‡å®šåˆ†æ”¯åˆå¹¶åˆ°å½“å‰åˆ†æ”¯</p><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cos">git <span class="hljs-keyword">merge</span> branch_name<br></code></pre></td></tr></table></figure><p>åˆ é™¤æŒ‡å®šåˆ†æ”¯</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">git branch -d branch_name</span><br></code></pre></td></tr></table></figure><h4 id="5-è¿œç¨‹æ“ä½œ"><a href="#5-è¿œç¨‹æ“ä½œ" class="headerlink" title="5.è¿œç¨‹æ“ä½œ"></a>5.è¿œç¨‹æ“ä½œ</h4><p>æŸ¥çœ‹è¿œç¨‹ä»“åº“</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">git remote -v</span><br></code></pre></td></tr></table></figure><p>æ·»åŠ è¿œç¨‹ä»“åº“</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">git</span> remote <span class="hljs-keyword">add</span> origin https:<span class="hljs-comment">//github.com/user/repo.git</span><br></code></pre></td></tr></table></figure><p>æ¨é€åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">git <span class="hljs-built_in">push</span> -u <span class="hljs-built_in">origin</span> branch_name<br></code></pre></td></tr></table></figure><p>æ¨é€å½“å‰åˆ†æ”¯</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">git <span class="hljs-built_in">push</span><br></code></pre></td></tr></table></figure><p>æ‹‰å–è¿œç¨‹ä»“åº“æ›´æ–°</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">git pull origin branch_name</span><br></code></pre></td></tr></table></figure><h4 id="6-æ’¤é”€æ›´æ”¹"><a href="#6-æ’¤é”€æ›´æ”¹" class="headerlink" title="6.æ’¤é”€æ›´æ”¹"></a>6.æ’¤é”€æ›´æ”¹</h4><p>æ¢å¤å·¥ä½œåŒºä¸­æ–‡ä»¶çš„æœ€æ–°æäº¤çŠ¶æ€</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">git checkout <span class="hljs-comment">-- filename</span><br></code></pre></td></tr></table></figure><p>é‡ç½®æš‚å­˜åŒºçš„æ–‡ä»¶ä¸ä¸Šä¸€æ¬¡æäº¤çš„çŠ¶æ€ä¸€è‡´</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas">git <span class="hljs-keyword">reset</span> HEAD <span class="hljs-keyword">filename</span><br></code></pre></td></tr></table></figure><p>é‡ç½®å½“å‰åˆ†æ”¯åˆ°æŒ‡å®šæäº¤</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">git <span class="hljs-keyword">reset</span> <span class="hljs-comment">--hard commit_hash</span><br></code></pre></td></tr></table></figure><h4 id="7-æŸ¥çœ‹å·®å¼‚"><a href="#7-æŸ¥çœ‹å·®å¼‚" class="headerlink" title="7.æŸ¥çœ‹å·®å¼‚"></a>7.æŸ¥çœ‹å·®å¼‚</h4><p>æŸ¥çœ‹å·¥ä½œåŒºå’Œæš‚å­˜åŒºä¹‹é—´çš„å·®å¼‚</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">git diff</span><br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æš‚å­˜åŒºå’Œæœ€åä¸€æ¬¡æäº¤ä¹‹é—´çš„å·®å¼‚</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">git diff <span class="hljs-comment">--cached</span><br></code></pre></td></tr></table></figure><h4 id="8-ä»åˆ›å»ºåˆ°æ¨é€çš„ç¤ºä¾‹"><a href="#8-ä»åˆ›å»ºåˆ°æ¨é€çš„ç¤ºä¾‹" class="headerlink" title="8.ä»åˆ›å»ºåˆ°æ¨é€çš„ç¤ºä¾‹"></a>8.ä»åˆ›å»ºåˆ°æ¨é€çš„ç¤ºä¾‹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1. åˆ›å»ºæ–°ä»“åº“</span><br><span class="hljs-built_in">mkdir</span> myproject<br><span class="hljs-built_in">cd</span> myproject<br>git init<br><br><span class="hljs-comment"># 2. æ·»åŠ æ–‡ä»¶å¹¶æäº¤</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Hello, Git&quot;</span> &gt; README.md<br>git add README.md<br>git commit -m <span class="hljs-string">&quot;Initial commit&quot;</span><br><br><span class="hljs-comment"># 3. æ·»åŠ è¿œç¨‹ä»“åº“</span><br>git remote add origin https://github.com/user/repo.git<br><br><span class="hljs-comment"># 4. æ¨é€åˆ°è¿œç¨‹ä»“åº“</span><br>git push -u origin master<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å­¦æµ·æ— æ¶¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
